
<!DOCTYPE html>

<html>
<head><meta content="noindex,nofollow" name="robots"/>
<title>Pattern Matching Wrap-Up</title>
<meta charset="utf-8"/>
<meta content="Martin Odersky" name="author">
<link href="../_/https/www.artima.com/artima.css" rel="stylesheet" type="text/css"/>
<link href="../_/https/www.artima.com/favicon.ico" rel="shortcut icon"/>
</meta></head>
<body><table cellspacing="0" width="100%">
<tr>
<td align="left" valign="bottom">
<a href="../_/https/www.artima.com/index.html"><img alt="The Artima Developer Community" border="0" height="43" src="../_/https/www.artima.com/images/a7.gif" width="550"/></a>
</td>
</tr></table>
<table bgcolor="#333333" width="100%">
<tr>
<td align="center">
<div class="ml">
<a class="hl" href="../_/https/www.artima.com/articles/index.html">Articles</a> |
<a class="hl" href="../_/https/www.artima.com/news/index.html">News</a> |
<a class="hl" href="../index.html">Weblogs</a> |
<a class="hl" href="../_/https/www.artima.com/shop/catalog/index.html">Books</a> |
<a class="hl" href="../_/https/www.artima.com/forums/index.html">Forums</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#CCCCCC" width="100%">
<tr>
<td align="center">
<div class="sc">
<a href="../index.html">Artima Weblogs</a> | 

<a href="../index.html$/blogger=modersky.html">Martin Odersky's Weblog</a> | 

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=168839.html">Discuss</a> | 
<a href="mailto:?subject=Pattern Matching Wrap-Up&amp;body= %0AArtima Weblogs %0APattern Matching Wrap-Up %0Aby Martin Odersky %0A%0Ahttps://www.artima.com/weblogs/viewpost.jsp?thread=168839">Email</a> | 
<a href="../viewpostP.html$/thread=168839.html">Print</a> | 
<a href="../bloggers.html">Bloggers</a> | 
<a class="sl" href="thread=166742.html" title="In Defense of Pattern Matching">Previous</a> | 
<a class="sl" href="thread=179766.html" title="Pimp my Library">Next</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#EEEEEE" width="100%">
<tr>
<td align="center">
<div class="sc">
<span style="color: #555555;">Sponsored Link</span> <span style="color: #888888;">•</span>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
   if (!document.phpAds_used) document.phpAds_used = ',';
   phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
   
   document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
   document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
   document.write ("&amp;what=zone:9&amp;target=_top");   document.write ("&amp;exclude=" + document.phpAds_used);
   if (document.referrer)
      document.write ("&amp;referer=" + escape(document.referrer));
   document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a799ecf6.html" target="_top"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:9&amp;n=a0587811.html"/></a></noscript>
</div>
</td>
</tr>
</table>
<br/>
<div class="vegies">
<div class="tc">
<span class="sts">Ideas, Languages, and Programs</span><br>
<span class="ts">Pattern Matching Wrap-Up</span><br/>
<span class="as">by Martin Odersky</span><br/>
<span class="pd">July 18, 2006</span><br/>
</br></div>
<blockquote>
<b>Summary</b><br/>
A follow-up on my previous blog on pattern matching, which summarizes the discussions this entailed.

</blockquote>
<hr align="left" width="90%"/>
<table align="right">
<tr>
<td>
<div class="adnotice">
Advertisement
</div>
<center>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
if (!document.phpAds_used) document.phpAds_used = ',';
phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
document.write ("&amp;what=zone:2");
document.write ("&amp;exclude=" + document.phpAds_used);
if (document.referrer)
document.write ("&amp;referer=" + escape(document.referrer));
document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a74ab060.html" target="_blank"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:2&amp;n=a74ab060.html"/></a></noscript>
</center>
</td>
</tr>
</table>
<p>
<p>The previous blog <a class="reference" href="../_/http/www.artima.com/weblogs/viewpost.html$/thread=166742.html">In Defense of Pattern Matching</a> has sparked many
interesting discussions.  I will try to give a quick wrap-up here.
Besides some technical questions, most comments fell into two
categories: They were wishing for more flexible and abstract schemes
how objects can be matched into patterns, or they were proposing a
classical object-oriented decomposition with virtual method calls as a
better alternative to pattern matching.</p>
<p><strong>More flexible patterns</strong> This was very constructive. It's great motivation
for us to continue exploring ways to make pattern matching more flexible. In
fact there had been a discussion about this on the <a class="reference" href="../_/http/news.gmane.org/gmane.comp.lang.scala">Scala mailing
list</a> before.  One thing to note here is that current
pattern matching already provides quite a bit of flexibility (this
should not imply that we should stop trying to generalize it
further). Take, for instance, the prototypical example of points:</p>
<pre class="literal-block">
case class Point(x: double, y: double)
</pre>
<p>One might think this would lock us into a specific
implementation of Points with cartesian x/y co-ordinates.  But in
fact, we could create a new sub-class of points with polar coordinates:</p>
<pre class="literal-block">
class PolarPoint(radius: double, angle: double) extends Point(
  Math.sin(angle) * r, Math.cos(angle) * r )
</pre>
<p>Even though these points now use internally a polar representation, their
pattern matching would be cartesian. So we see that values
returned by pattern matching need not correspond to an
object's internal data representation. In that sense, encapsulation is
preserved.</p>
<p><strong>Multi-methods</strong> are a flexible alternative to pattern matching. They
are not present in Scala. I think multi-methods would be great if they
could replace Java's static overloading, which always seemed a bit
ad-hoc to me. The question is whether one can do this without breaking
compatibility with Java in too serious ways. Maybe the <a class="reference" href="../nice.sourceforge.net">Nice</a> folks
have some experience to offer here? I have noted that some
multi-method designs, such as <a class="reference" href="../multijava.sourceforge.net">MultiJava</a>, have both static overloading
and multi-methods; however I fear this would be too confusing for
users.</p>
<p><strong>Philosophy</strong> Another class of arguments criticized pattern matching on
more fundamental grounds. Basically it goes as follows:</p>
<blockquote>
"Sure, pattern matching is a more convenient alternative to Java's
instanceof and type casts. But all of these techniques are inferior
to a proper object-oriented decomposition, where you use virtual
methods to differentiate behavior in subclasses."</blockquote>
<p>I believe this argument is valid in many cases, but not in all.  There
are situations where an OO decomposition is not easily doable. An
example that's right under our noses is the try-catch statement found
in Java and many other languages. In Scala it is written like this:</p>
<pre class="literal-block">
try {
  ...
} catch {
  case ex: IOException =&gt; "handle io error"
  case ex: ClassCastException =&gt; "handle class cast errors"
  case ex: _ =&gt; "generic recovery"
}
</pre>
<p>Here, every catch clause does a pattern match on the thrown exception
(using a so-called "typed pattern"). In the equivalent Java code this is
less obvious but in essence Java catch clauses contain
pattern matches as well. What would the strict OO alternative be? To
choose the correct handler code we'd have to call a
virtual method in the thrown exception.  The problem is that the
exception itself does not not "know" how the handler should react to
it; this clearly depends on the context. It is possible to program
around this using the <a class="reference" href="../_/http/en.wikipedia.org/wiki/Visitor_pattern/index.html">visitor pattern</a>, but the result is clumsy and
not easily extensible to new kinds of exceptions.  That's probably why
most languages have opted for exception handling in the
pattern-matching style.</p>
<p>There are arguably many more cases where a decomposition from the
outside is preferable to a decomposition from the inside using virtual
methods. Cases to watch out for are:</p>
<blockquote>
<ol class="arabic simple">
<li>when a computation rule involves several objects,</li>
<li>when a computation cannot usefully be defined as a member of the
class on which we want to differentiate.</li>
</ol>
</blockquote>
<p>An example of the first kind is the following
rule from my <a class="reference" href="../_/http/lamp.epfl.ch/~odersky/blogs/examples/pattern-matching.html">term simplification example</a>:</p>
<pre class="literal-block">
x * l + x * r  ==  x * (l + r)
</pre>
<p>The corresponding simplification rule in Scala is:</p>
<pre class="literal-block">
case Add(Mul(x1, l), Mul(x2, r)) if (x1 == x2) =&gt; Mul(x1, Add(l, r))
</pre>
<p>An example of the second kind are exception handlers, discussed above.</p>
<p>In summary, I do believe there is a role for pattern matching in
object-oriented languages. But with the added power comes the 
requirement that programmers now have to choose a style of decomposition. 
This can sometimes be difficult.</p>
<h1>Talk Back!</h1>
<p>
Have an opinion?


Readers have already posted

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=168839.html">12

comments</a>
about this weblog entry. Why not

<a href="../_/https/www.artima.com/forums/post.html$/forum=106&amp;thread=168839&amp;reply=true.html">add yours</a>?


<h1>RSS Feed</h1>
<p>
If you'd like to be notified whenever Martin Odersky adds a new entry to <a href="../index.html$/blogger=modersky.html">his weblog</a>, subscribe to his <a href="../feeds/bloggers/modersky.rss">RSS feed</a>.

<center>
<div class="sociallinks">
<a href="../_/http/digg.com/submit$/phase=2&amp;url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D168839&amp;title=Pattern+Matching+Wrap-Up&amp;bodytext=A+follow-up+on+my+previous+blog+on+pattern+matching%2C+which+summarizes+the+discussions+this+entailed.&amp;topic=programming">
<img alt="Digg" border="0" height="14" hspace="8" src="../_/https/www.artima.com/images/digg.gif" width="16">Digg
  </img></a>
  |
  <a href="../_/http/del.icio.us/post$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D168839&amp;title=Pattern+Matching+Wrap-Up">
<img alt="del.icio.us" border="0" height="16" hspace="8" src="../_/https/www.artima.com/images/delicious.gif" vspace="1" width="16">del.icio.us
  </img></a>
  |
  <a href="../_/http/programming.reddit.com/submit$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D168839&amp;title=Pattern+Matching+Wrap-Up">
<img alt="Reddit" border="0" height="18" hspace="8" src="../_/https/www.artima.com/images/reddit.gif" width="18"/>Reddit
  </a>
</div>
</center>
<h1>About the Blogger</h1>
<p>
<table><tr valign="bottom"><td><img align="right" src="../_/https/www.artima.com/images/martinodersky.jpg"/></td><td>Martin Odersky is the inventor of the Scala language and professor at <a href="../_/http/ic.epfl.ch/index.html">EPFL</a> in Lausanne, Switzerland. In 2008, he was appointed fellow of the ACM for his contributions to the fusion of functional and object-oriented programming. He believes the two paradigms are two sides of the same coin, to be
unified as much as possible. To prove this, he has worked on
a number of language designs, from <a href="../_/http/lampwww.epfl.ch/pizza/index.html">Pizza</a> to <a href="../_/http/lamp.epfl.ch/pizza/gj/index.html">GJ</a> to <a href="../_/http/lamp.epfl.ch/funnel/index.html">Functional Nets</a>.  He has also
influenced the development of Java as a co-designer of <a href="../_/http/jcp.org/en/jsr/detail$/id=14/index.html">Java generics</a> and as the
original author of the current <a href="../_/http/java.sun.com/j2se/1.4.2/docs/tooldocs/windows/javac.html">javac<a></a>

reference compiler.</a></td></tr></table><p>
<div class="sp">This weblog entry is Copyright © 2006 Martin Odersky. All rights reserved.</div>
</p></p></p></p></p></div>

<hr width="100%">
<table align="center" width="50%">
<tr>
<td>
<div class="horizontaltextadbox">
<div class="adheadline">Sponsored Links</div>
<div id="sponsoredlinks">
</div>
</div>
</td>
</tr>
</table>
<hr width="100%"/>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3911176865765226";
google_alternate_color = "ffffff";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "003090";
google_color_text = "000000";
google_color_url = "666666";
//--></script>
<script src="../_/https/pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<br>
<br/>
<!-- SiteSearch Google -->
<form action="../_/https/www.google.com/custom/index.html" method="get">
<table bgcolor="#ffffff" border="0">
<tr><td align="left" height="32" nowrap="nowrap" valign="top">
<a href="../_/https/www.google.com/index.html">
<img alt="Google" border="0" src="../_/https/www.google.com/logos/Logo_25wht.gif"/></a>
</td>
<td nowrap="nowrap">
<input name="domains" type="hidden" value="Artima.com"/>
<input maxlength="255" name="q" size="31" type="text" value=""/>
<input name="sa" type="submit" value="Search"/>
</td></tr>
<tr>
<td> </td>
<td nowrap="nowrap">
<font color="#000000" size="-1">
<input name="sitesearch" type="radio" value=""/> Web
<input checked="checked" name="sitesearch" type="radio" value="Artima.com"/>Artima.com
</font>  
<input name="client" type="hidden" value="pub-3911176865765226"/>
<input name="forid" type="hidden" value="1"/>
<input name="ie" type="hidden" value="ISO-8859-1"/>
<input name="oe" type="hidden" value="ISO-8859-1"/>
<input name="cof" type="hidden" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:FFFFFF;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:150;L:https://www.artima.com/images/artima150.gif;S:https://www.artima.com;FORID:1;"/>
<input name="hl" type="hidden" value="en"/>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</br></center>
<br/>
<div class="sp">
<div style="text-align: center;">
<a href="../_/https/www.artima.com/copyright.html">Copyright</a> © 1996-2019 Artima, Inc. All Rights Reserved. - <a href="../_/https/www.artima.com/privacy.html">Privacy Policy</a> - <a href="../_/https/www.artima.com/termsofuse.html">Terms of Use</a>
</div>
</div>
<br/>
<script language="JavaScript" type="text/javascript">
<!--
function initBannerVarForZone(zone) {
        initBannerVarForZoneWithScript(zone, 'adjs_modified');
}

function initBannerVarForZoneWithScript(zone, phpScript) {

        if (!document.phpAds_used) document.phpAds_used = ',';
        phpAds_random = new String (Math.random());
        phpAds_random = phpAds_random.substring(2,11);

        var nextScriptSrc = '../_/https/www.artima.com/zcr/index.html' + phpScript + '.php?n=' +
                phpAds_random  +
                '&amp;what=zone:' + zone + '&amp;target=_top&amp;block=1&amp;blockcampaign=1' +
                '&amp;exclude=' + document.phpAds_used;

        document.write("<script language='JavaScript' type='text/javascript' src='");
        document.write(nextScriptSrc);
        document.write("'><\/script>");

}

function replaceDiv(divID) {
        document.getElementById(divID).innerHTML = phpadsbanner;
}
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZone(3);
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('leftskyscraper');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZoneWithScript(4, 'textman');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('sponsoredlinks');
-->
</script>
</hr><a href="https://dafoster.net/projects/crystal-web-archiver/" id="cr-footer-banner" style="border-top: 2px #B40010 solid;background: #FFFAE1;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-variant: initial;font-weight: initial;text-transform: none;font-size: 14px;color: #6c757d;line-height: 2.0;cursor: pointer;display: flex;align-items: center;justify-content: center;gap: 4px;clear: both;" target="_blank"><img height="24" onerror="this.style['display'] = 'none';" src="../_/crystal/resources/appicon.png" width="24"/><span>This page was archived with Crystal</span><script>window.addEventListener('load', function() { const $1 = document.querySelector('#cr-footer-banner'); if (!$1) { return; } if (window !== window.top) { let $2 = false; if (window.name) { const $3 = window.parent.document.getElementsByName(window.name); if ($3.length === 1) { const $4 = $3[0]; if ($4.tagName === 'FRAME' && $4.parentElement.tagName === 'FRAMESET') { let $5 = $4; while (true) { if ($5.parentElement.tagName !== 'FRAMESET') { $2 = true; break; } if ($5.parentElement.attributes['rows'] !== undefined) { const $6 = $5.parentElement.children; if ($5 === $6[$6.length - 1]) { $5 = $5.parentElement; continue; } else { break; } } else if ($5.parentElement.attributes['cols'] !== undefined) { const $7 = Array.from($5.parentElement.children); const $8 = $7.indexOf($5); if ($8 === -1) { break; } const $9 = $5.parentElement.attributes['cols'].value.split(','); const $10 = $9.map((s) => parseInt(s.trim())); if ($9[$8].trim() === '*' || $10[$8] === Math.max.apply(null, $10)) { $5 = $5.parentElement; continue; } else { break; } } else { break; } } } } } if (!$2) { $1.style['display'] = 'none'; } } const $11 = $1.getBoundingClientRect(); const $12 = ($11.y < window.innerHeight - $11.height); if ($12) { $1.style['position'] = 'fixed'; $1.style['bottom'] = '0'; $1.style['left'] = '0'; $1.style['right'] = '0'; $1.style['z-index'] = '9999'; } const $13 = ( document.body.getBoundingClientRect().height < $11.height * 2 ); if ($13) { $1.style['display'] = 'none'; }
});</script></a></body>
</html>
