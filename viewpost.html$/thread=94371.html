
<!DOCTYPE html>

<html>
<head><meta content="noindex,nofollow" name="robots"/>
<title>Is Complete Test Coverage Desirable - or Even Attainable?</title>
<meta charset="utf-8"/>
<meta content="Frank Sommers" name="author">
<link href="../_/https/www.artima.com/artima.css" rel="stylesheet" type="text/css"/>
<link href="../_/https/www.artima.com/favicon.ico" rel="shortcut icon"/>
</meta></head>
<body><table cellspacing="0" width="100%">
<tr>
<td align="left" valign="bottom">
<a href="../_/https/www.artima.com/index.html"><img alt="The Artima Developer Community" border="0" height="43" src="../_/https/www.artima.com/images/a7.gif" width="550"/></a>
</td>
</tr></table>
<table bgcolor="#333333" width="100%">
<tr>
<td align="center">
<div class="ml">
<a class="hl" href="../_/https/www.artima.com/articles/index.html">Articles</a> |
<a class="hl" href="../_/https/www.artima.com/news/index.html">News</a> |
<a class="hl" href="../index.html">Weblogs</a> |
<a class="hl" href="../_/https/www.artima.com/shop/catalog/index.html">Books</a> |
<a class="hl" href="../_/https/www.artima.com/forums/index.html">Forums</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#CCCCCC" width="100%">
<tr>
<td align="center">
<div class="sc">
<a href="../index.html">Artima Weblogs</a> | 

<a href="../index.html$/blogger=fsommers.html">Frank Sommers' Weblog</a> | 

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=94371.html">Discuss</a> | 
<a href="mailto:?subject=Is Complete Test Coverage Desirable - or Even Attainable?&amp;body= %0AArtima Weblogs %0AIs Complete Test Coverage Desirable - or Even Attainable? %0Aby Frank Sommers %0A%0Ahttps://www.artima.com/weblogs/viewpost.jsp?thread=94371">Email</a> | 
<a href="../viewpostP.html$/thread=94371.html">Print</a> | 
<a href="../bloggers.html">Bloggers</a> | 
<a class="sl" href="thread=90926.html" title="Is Test-First Development an Impediment to Creative Flow?">Previous</a> | 
<a class="sl" href="thread=96154.html" title="The Code Quality Myth">Next</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#EEEEEE" width="100%">
<tr>
<td align="center">
<div class="sc">
<span style="color: #555555;">Sponsored Link</span> <span style="color: #888888;">•</span>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
   if (!document.phpAds_used) document.phpAds_used = ',';
   phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
   
   document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
   document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
   document.write ("&amp;what=zone:9&amp;target=_top");   document.write ("&amp;exclude=" + document.phpAds_used);
   if (document.referrer)
      document.write ("&amp;referer=" + escape(document.referrer));
   document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a799ecf6.html" target="_top"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:9&amp;n=a0587811.html"/></a></noscript>
</div>
</td>
</tr>
</table>
<br/>
<div class="vegies">
<div class="tc">
<span class="sts">Frank Thoughts</span><br>
<span class="ts">Is Complete Test Coverage Desirable - or Even Attainable?</span><br/>
<span class="as">by Frank Sommers</span><br/>
<span class="pd">February 16, 2005</span><br/>
</br></div>
<blockquote>
<b>Summary</b><br/>
Testing code is different from testing a system. Code in real-world, production systems has to contend with an ever changing, often unpredictable environment that renders unit tests an unreliable predictor of system behavior. In the real world, system robustness matters, but writing more tests can produce diminishing returns.

</blockquote>
<hr align="left" width="90%"/>
<table align="right">
<tr>
<td>
<div class="adnotice">
Advertisement
</div>
<center>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
if (!document.phpAds_used) document.phpAds_used = ',';
phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
document.write ("&amp;what=zone:2");
document.write ("&amp;exclude=" + document.phpAds_used);
if (document.referrer)
document.write ("&amp;referer=" + escape(document.referrer));
document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a74ab060.html" target="_blank"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:2&amp;n=a74ab060.html"/></a></noscript>
</center>
</td>
</tr>
</table>
<p>
Do unit tests instill in us a false sense of certainty?
                                                                                           <p>

That's how I felt the other night. Bill Venners (Artima's chief editor) and
I were helping a group of developers at a <a href="../_/http/c2.com/cgi/wiki$/SiliconValleyPatternsGroup/index.html">Silicon Valley Patterns Group</a> meeting. Our
goal that evening was to build a Jini and JavaSpaces compute grid.  Before
everyone could go to work on grid code, we needed to get Jini lookup services up and
running on an impromptu wireless network assembled at the back room of <a href="../_/http/www.hobees.com/cupertino.html">Hobee's</a> restaurant in Cupertino.
                                                                                           <p>

The <a href="../_/http/www.jini.org/index.html">Jini Starter Kit</a>, which Sun will soon <a href="../_/http/www.internetnews.com/dev-news/article.php/3461651/index.html">open-source</a>, is as high quality and
throughly tested a piece of code as code gets. Indeed, the JSK is used to run
high-volume business-critical transactions at a handful of <a href="../_/http/www.computerworld.com/softwaretopics/software/appdev/story/0,10801,95664,00.html">large corporations</a>. Starting up Jini lookup services with the JSK is typically a snap.
                                                                                           <p>

But it wasn't so that night. We struggled for an hour with this normally simple step,
having to adjust several aspects of users' local environment: moving files around,
deleting directories, checking for multicast capability on network interfaces, etc.
The exercise was frustrating to those who, just a few short hours prior to our
meeting, were able to run Jini lookup services on the very same laptops they brought
with them to the meeting. The rigorous testing and QA processes followed by the Jini
developers predicted nothing about how well the system would work on our impromptu
network that night.
<p>

A few days later, Bill and I were sitting just a few yards away from Hobee's, trying
to start up a new version of Artima code. Before checking in that code, I made sure
that all the over one hundred unit tests for that module passed. Yet, when Bill
checked that code out and started up the Web app on <em>his</em> laptop, a subtle
configuration issue prevented the app from working as intended. While code itself was
tested, the system relied on configuration options that were defined partially
outside the code. The unit tests, again, were no indication of whether the code would
run at all in a real-world environment.
                                                                                           <p>

Were our tests, or the Jini JSK's tests, flawed? How could we account for
environmental exigencies in those tests? How deep should we aim for in our test
coverage? Should we strive to cover all the permutations of code and its environment
in our test suites? Is such complete test coverage of code even attainable?
                                                                                           
<h2>System Matters</h2>
                                                                                           
These experiences made me appreciate the distinction between testing code and testing
a <em>system</em>. The real world only cares about the system - the actual
interaction of all the code in a given piece of software with its environment. Unit
tests, on the other hand, mostly test code: Unit tests are proof that a given method,
or set of methods, act in accord with a given set of assertions.
                                                                                           <p>

Unit tests are also code. When running a set of unit tests, the code that's being
tested and the test code itself become part of the same environment - they are part
and parcel of the same system. But if unit tests are part of the system that's being
tested, can unit tests prove anything about the system itself?
                                                                                           <p>

No lesser a logician than <a href="../_/http/www.time.com/time/time100/scientist/profile/godel.html">Kurt Gödel</a> had <a href="../_/http/www.miskatonic.org/godel.html">something to say</a> about this. To be sure,
Gödel's concern was algebraic proof, not unit testing. But in addressing the false
sense of certainty implied in Bertrand Russell's <a href="../_/http/plato.stanford.edu/entries/principia-mathematica/index.html">Principia Mathematica</a>, Gödel <a href="../_/http/www.amazon.com/exec/obidos/ASIN/0814703259/002-0901285-4231255/index.html">demonstrated</a> that it is not possible to prove all aspects of a system from within a system itself. In every logical system, there must be axioms - truths that must be taken for granted, and that can be demonstrated true or false only by stepping outside the system.
<p>

Such axioms are present in any software system: We must assume that the CPU works as
advertised, that the file system behaves as intended, that the compiler produces
correct code. Not only can we not test for those assumptions from within the system,
we also cannot recover from situations where the axiomatic aspects of the system turn
out to be invalid. If any of a system's axioms turn out to be wrong, the system
suffers <em>catastrophic failure</em> - failure from which no recovery is possible
from within the system itself. In practical terms, you will just have to reboot.
                                                                                           <p>

A cardinal aspect of a test plan, then, is to determine a system's axioms, or aspects
(not in the AOP sense) that cannot be proven true or false from within the system.
Apart from those system axioms, all other aspects of the system can, and should, be
covered in the test plan.
                                                                                           <p>

The fewer the axioms, the more testable the system. Fewer axioms also result in less
possibilities for catastrophic failure. But in any system, there will always be
conditions that cause complete system failure - <a href="../_/http/www.littlewhitedog.com/article-print-3418.html">CTRL-ALT-DEL</a> will be with us for
good. Fully autonomous, infallible systems truly belong in the realms of science
fiction and fantasy.
                                                                                           
                                                                                           
<h2>Degrees of Belief</h2>
                                                                                           
If we accept that there will always be a few aspects of a system that we cannot write
tests for, aspects whose correctness we must take for granted, how do we decide on
those "axioms"?
<p>

Do you write test methods for simple property accessor methods, or do you just assume
that the JVM does what it's supposed to do? Do you write a test to ensure that a
database, indeed, inserts a record, or do you decide to take that operation for
granted? Do you just assume that a network connection can be opened to a host - is
that operation a system "axiom"? And do you just assume that a remote RMI call will
return as intended, or do you write test for all sorts of network failures, along
with possible recovery code? Finally, do you just assume that a user types a correct
piece of data in an HTML form, or do you write tests and error handling code in that
situation?
                                                                                           <p>

Clearly, there is a spectrum, and we often make our decisions about our "system
axioms" based on our beliefs of certainty about correctness. Most of us are highly
uncertain that every user always enters the right answer in a form, so we always
write tests in that situation. But most of us are fairly sure that a database can
perform an insert just fine, so writing tests for that operation would seem like a
waste of time, unless we're testing the database itself.
                                                                                           <p>

If our decisions about what to take for granted in a system is based on such degrees
of belief, and if tests start where "axioms" end, then the degree to which testing
tells us about a system's behavior in the larger, operating context of that system,
is also dependent on those beliefs.
                                                                                           <p>

The Jini code, for instance, assumed that multicast is enabled on all network hosts.
The Artima code took a specific configuration for granted, and assumed that that
configuration is the one supplied at system startup. We didn't test for that, just
assumed that that is always so. The tests passed, but the system still failed when
that condition was not satisfied in a different operating environment.
                                                                                           <p>

In addition to beliefs, we also have to contend with market pressures when choosing
system "axioms." You may know that a remote method call can fail a hundred different
ways on the network, but you also know that shipping a product today, as opposed to
tomorrow, can lead to a market share gain. So you decide to not test for all those
possible network failures, and to take the "correctness" of the network for granted.
You hope you get lucky.

<h2>Past Behavior</h2>
                                                                                           
We could improve our degrees of beliefs about system correctness if we analyzed past
system behavior. One way to do this is to rely on experience. But another way to do
this is to follow what a better search engine, such as Google, does: The more we use
the system, the better the system gets because it learns form past data to improve
its results.
                                                                                           <p>

We could instrument code in such a way as to capture failure conditions (e.g., by
logging exceptions). We could then tell that, for example, one out of every N remote
calls on a proxy interface results in failure, given the typical operating environment
of that code. Note that that's real-world data, not just assumptions. Then we could
assign the inverse of that measure - the degree of probability that the call succeeds
- to that method call. We could then correlate that information to how often a call
is used, and produce a matrix of the results.
                                                                                           <p>

That probability matrix would be a more accurate indicator of the code's actual
reliability - or "quality" - than just having a set of tests that happen to all run
fine on a developer's machine. Such information would help developers pinpoint what
"system axioms" are valid, and what assumptions prove incorrect in the real world.
                                                                                           <p>

With that information, we would not need to strive for complete code coverage, only
coverage that leads to a desired quality level. That would, in turn, make us all more
productive.
                                                                                           <p>

I think it may even be possible to find emergent patterns in code with a probability
matrix of that code shared on the Web. Coverage and testing tools could tap into that
database to make better decisions about where to apply unit tests, and about how
indicative existing unit tests are about actual code behavior.
<p>

That said, I'm curious how others deal with ensuring proper configuration, and how others account for configuration options in tests. What are some of the ways to minimize configuration so as to reduce the chances of something going wrong? Then, again, isn't reducing configuration is also reducing flexibility and "agility?"

<p>
In general, do you agree with my conclusion that complete test coverage is not desirable, or even attainable? How do you choose what to test and what not to test? How do you pick your "system axioms"?

<h1>Talk Back!</h1>
<p>
Have an opinion?


Readers have already posted

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=94371.html">21

comments</a>
about this weblog entry. Why not

<a href="../_/https/www.artima.com/forums/post.html$/forum=106&amp;thread=94371&amp;reply=true.html">add yours</a>?


<h1>RSS Feed</h1>
<p>
If you'd like to be notified whenever Frank Sommers adds a new entry to <a href="../index.html$/blogger=fsommers.html">his weblog</a>, subscribe to his <a href="../feeds/bloggers/fsommers.rss">RSS feed</a>.

<center>
<div class="sociallinks">
<a href="../_/http/digg.com/submit$/phase=2&amp;url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D94371&amp;title=Is+Complete+Test+Coverage+Desirable+-+or+Even+Attainable%3F&amp;bodytext=Testing+code+is+different+from+testing+a+system.+Code+in+real-world%2C+production+systems+has+to+contend+with+an+ever+changing%2C+often+unpredictable+environment+that+renders+unit+tests+an+unreliable+predictor+of+system+behavior.+In+the+real+world%2C+system+_&amp;topic=programming">
<img alt="Digg" border="0" height="14" hspace="8" src="../_/https/www.artima.com/images/digg.gif" width="16">Digg
  </img></a>
  |
  <a href="../_/http/del.icio.us/post$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D94371&amp;title=Is+Complete+Test+Coverage+Desirable+-+or+Even+Attainable%3F">
<img alt="del.icio.us" border="0" height="16" hspace="8" src="../_/https/www.artima.com/images/delicious.gif" vspace="1" width="16">del.icio.us
  </img></a>
  |
  <a href="../_/http/programming.reddit.com/submit$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D94371&amp;title=Is+Complete+Test+Coverage+Desirable+-+or+Even+Attainable%3F">
<img alt="Reddit" border="0" height="18" hspace="8" src="../_/https/www.artima.com/images/reddit.gif" width="18"/>Reddit
  </a>
</div>
</center>
<h1>About the Blogger</h1>
<p>
<table><tr valign="bottom"><td><img align="right" src="../_/https/www.artima.com/images/frank.jpg"/></td><td>Frank Sommers is a Senior Editor with Artima Developer. Prior to joining Artima, Frank wrote the Jiniology and Web services columns for JavaWorld. Frank also serves as chief editor of the Web zine <em>ClusterComputing.org</em>, the IEEE Technical Committee on Scalable Computing's newsletter. Prior to that, he edited the Newsletter of the IEEE Task Force on Cluster Computing. Frank is also founder and president of Autospaces, a company dedicated to bringing service-oriented computing to the automotive software market.

<p>
Prior to Autospaces, Frank was vice president of technology and chief software architect at a Los Angeles system integration firm. In that capacity, he designed and developed that company's two main products: A financial underwriting system, and an insurance claims management expert system. Before assuming that position, he was a research fellow at the Center for Multiethnic and Transnational Studies at the University of Southern California, where he participated in a geographic information systems (GIS) project mapping the ethnic populations of the world and the diverse demography of southern California. Frank's interests include parallel and distributed computing, data management, programming languages, cluster and grid computing, and the theoretic foundations of computation. He is a member of the ACM and IEEE, and the American Musicological Society.</p></td></tr></table><p>
<div class="sp">This weblog entry is Copyright © 2005 Frank Sommers. All rights reserved.</div>
</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></div>

<hr width="100%">
<table align="center" width="50%">
<tr>
<td>
<div class="horizontaltextadbox">
<div class="adheadline">Sponsored Links</div>
<div id="sponsoredlinks">
</div>
</div>
</td>
</tr>
</table>
<hr width="100%"/>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3911176865765226";
google_alternate_color = "ffffff";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "003090";
google_color_text = "000000";
google_color_url = "666666";
//--></script>
<script src="../_/https/pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<br>
<br/>
<!-- SiteSearch Google -->
<form action="../_/https/www.google.com/custom/index.html" method="get">
<table bgcolor="#ffffff" border="0">
<tr><td align="left" height="32" nowrap="nowrap" valign="top">
<a href="../_/https/www.google.com/index.html">
<img alt="Google" border="0" src="../_/https/www.google.com/logos/Logo_25wht.gif"/></a>
</td>
<td nowrap="nowrap">
<input name="domains" type="hidden" value="Artima.com"/>
<input maxlength="255" name="q" size="31" type="text" value=""/>
<input name="sa" type="submit" value="Search"/>
</td></tr>
<tr>
<td> </td>
<td nowrap="nowrap">
<font color="#000000" size="-1">
<input name="sitesearch" type="radio" value=""/> Web
<input checked="checked" name="sitesearch" type="radio" value="Artima.com"/>Artima.com
</font>  
<input name="client" type="hidden" value="pub-3911176865765226"/>
<input name="forid" type="hidden" value="1"/>
<input name="ie" type="hidden" value="ISO-8859-1"/>
<input name="oe" type="hidden" value="ISO-8859-1"/>
<input name="cof" type="hidden" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:FFFFFF;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:150;L:https://www.artima.com/images/artima150.gif;S:https://www.artima.com;FORID:1;"/>
<input name="hl" type="hidden" value="en"/>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</br></center>
<br/>
<div class="sp">
<div style="text-align: center;">
<a href="../_/https/www.artima.com/copyright.html">Copyright</a> © 1996-2019 Artima, Inc. All Rights Reserved. - <a href="../_/https/www.artima.com/privacy.html">Privacy Policy</a> - <a href="../_/https/www.artima.com/termsofuse.html">Terms of Use</a>
</div>
</div>
<br/>
<script language="JavaScript" type="text/javascript">
<!--
function initBannerVarForZone(zone) {
        initBannerVarForZoneWithScript(zone, 'adjs_modified');
}

function initBannerVarForZoneWithScript(zone, phpScript) {

        if (!document.phpAds_used) document.phpAds_used = ',';
        phpAds_random = new String (Math.random());
        phpAds_random = phpAds_random.substring(2,11);

        var nextScriptSrc = '../_/https/www.artima.com/zcr/index.html' + phpScript + '.php?n=' +
                phpAds_random  +
                '&amp;what=zone:' + zone + '&amp;target=_top&amp;block=1&amp;blockcampaign=1' +
                '&amp;exclude=' + document.phpAds_used;

        document.write("<script language='JavaScript' type='text/javascript' src='");
        document.write(nextScriptSrc);
        document.write("'><\/script>");

}

function replaceDiv(divID) {
        document.getElementById(divID).innerHTML = phpadsbanner;
}
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZone(3);
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('leftskyscraper');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZoneWithScript(4, 'textman');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('sponsoredlinks');
-->
</script>
</hr><a href="https://dafoster.net/projects/crystal-web-archiver/" id="cr-footer-banner" style="border-top: 2px #B40010 solid;background: #FFFAE1;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-variant: initial;font-weight: initial;text-transform: none;font-size: 14px;color: #6c757d;line-height: 2.0;cursor: pointer;display: flex;align-items: center;justify-content: center;gap: 4px;clear: both;" target="_blank"><img height="24" onerror="this.style['display'] = 'none';" src="../_/crystal/resources/appicon.png" width="24"/><span>This page was archived with Crystal</span><script>window.addEventListener('load', function() { const $1 = document.querySelector('#cr-footer-banner'); if (!$1) { return; } if (window !== window.top) { let $2 = false; if (window.name) { const $3 = window.parent.document.getElementsByName(window.name); if ($3.length === 1) { const $4 = $3[0]; if ($4.tagName === 'FRAME' && $4.parentElement.tagName === 'FRAMESET') { let $5 = $4; while (true) { if ($5.parentElement.tagName !== 'FRAMESET') { $2 = true; break; } if ($5.parentElement.attributes['rows'] !== undefined) { const $6 = $5.parentElement.children; if ($5 === $6[$6.length - 1]) { $5 = $5.parentElement; continue; } else { break; } } else if ($5.parentElement.attributes['cols'] !== undefined) { const $7 = Array.from($5.parentElement.children); const $8 = $7.indexOf($5); if ($8 === -1) { break; } const $9 = $5.parentElement.attributes['cols'].value.split(','); const $10 = $9.map((s) => parseInt(s.trim())); if ($9[$8].trim() === '*' || $10[$8] === Math.max.apply(null, $10)) { $5 = $5.parentElement; continue; } else { break; } } else { break; } } } } } if (!$2) { $1.style['display'] = 'none'; } } const $11 = $1.getBoundingClientRect(); const $12 = ($11.y < window.innerHeight - $11.height); if ($12) { $1.style['position'] = 'fixed'; $1.style['bottom'] = '0'; $1.style['left'] = '0'; $1.style['right'] = '0'; $1.style['z-index'] = '9999'; } const $13 = ( document.body.getBoundingClientRect().height < $11.height * 2 ); if ($13) { $1.style['display'] = 'none'; }
});</script></a></body>
</html>
