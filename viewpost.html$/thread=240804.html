
<!DOCTYPE html>

<html>
<head><meta content="noindex,nofollow" name="robots"/>
<title>The Adventures of a Pythonista in Schemeland/9</title>
<meta charset="utf-8"/>
<meta content="Michele Simionato" name="author">
<link href="../_/https/www.artima.com/artima.css" rel="stylesheet" type="text/css"/>
<link href="../_/https/www.artima.com/favicon.ico" rel="shortcut icon"/>
</meta></head>
<body><table cellspacing="0" width="100%">
<tr>
<td align="left" valign="bottom">
<a href="../_/https/www.artima.com/index.html"><img alt="The Artima Developer Community" border="0" height="43" src="../_/https/www.artima.com/images/a7.gif" width="550"/></a>
</td>
</tr></table>
<table bgcolor="#333333" width="100%">
<tr>
<td align="center">
<div class="ml">
<a class="hl" href="../_/https/www.artima.com/articles/index.html">Articles</a> |
<a class="hl" href="../_/https/www.artima.com/news/index.html">News</a> |
<a class="hl" href="../index.html">Weblogs</a> |
<a class="hl" href="../_/https/www.artima.com/shop/catalog/index.html">Books</a> |
<a class="hl" href="../_/https/www.artima.com/forums/index.html">Forums</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#CCCCCC" width="100%">
<tr>
<td align="center">
<div class="sc">
<a href="../index.html">Artima Weblogs</a> | 

<a href="../index.html$/blogger=micheles.html">Michele Simionato's Weblog</a> | 

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=240804.html">Discuss</a> | 
<a href="mailto:?subject=The Adventures of a Pythonista in Schemeland/9&amp;body= %0AArtima Weblogs %0AThe Adventures of a Pythonista in Schemeland/9 %0Aby Michele Simionato %0A%0Ahttps://www.artima.com/weblogs/viewpost.jsp?thread=240804">Email</a> | 
<a href="../viewpostP.html$/thread=240804.html">Print</a> | 
<a href="../bloggers.html">Bloggers</a> | 
<a class="sl" href="thread=240793.html" title="The Adventures of a Pythonista in Schemeland/8">Previous</a> | 
<a class="sl" href="thread=240805.html" title="The Adventures of a Pythonista in Schemeland/10">Next</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#EEEEEE" width="100%">
<tr>
<td align="center">
<div class="sc">
<span style="color: #555555;">Sponsored Link</span> <span style="color: #888888;">•</span>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
   if (!document.phpAds_used) document.phpAds_used = ',';
   phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
   
   document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
   document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
   document.write ("&amp;what=zone:9&amp;target=_top");   document.write ("&amp;exclude=" + document.phpAds_used);
   if (document.referrer)
      document.write ("&amp;referer=" + escape(document.referrer));
   document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a799ecf6.html" target="_top"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:9&amp;n=a0587811.html"/></a></noscript>
</div>
</td>
</tr>
</table>
<br/>
<div class="vegies">
<div class="tc">
<span class="sts">The Explorer</span><br>
<span class="ts">The Adventures of a Pythonista in Schemeland/9</span><br/>
<span class="as">by Michele Simionato</span><br/>
<span class="pd">October 31, 2008</span><br/>
</br></div>
<blockquote>
<b>Summary</b><br/>
This episode is entirely devoted to Scheme macros from a personal point of view. Pattern matching is introduced as the fundamental mechanism on which macros
are built.

</blockquote>
<hr align="left" width="90%"/>
<table align="right">
<tr>
<td>
<div class="adnotice">
Advertisement
</div>
<center>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
if (!document.phpAds_used) document.phpAds_used = ',';
phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
document.write ("&amp;what=zone:2");
document.write ("&amp;exclude=" + document.phpAds_used);
if (document.referrer)
document.write ("&amp;referer=" + escape(document.referrer));
document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a74ab060.html" target="_blank"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:2&amp;n=a74ab060.html"/></a></noscript>
</center>
</td>
</tr>
</table>
<p>
<div class="section">
<h1><a id="a-minimal-introduction-to-scheme-macros" name="a-minimal-introduction-to-scheme-macros">A minimal introduction to Scheme macros</a></h1>
<p>Scheme macros have many faces. You can see them
as a general mechanism to extend the syntax of base Scheme, and
also as a mechanism to reduce boilerplate.
On the other hand, if you focus your attention on the fact that they work at
compile time, you can see them as a mechanism to perform arbitrary computations
at compile time, including compile time checks.</p>
<p>I think the correct way of looking at macros is to see them as a
general facility to write compilers for micro-languages - or Domain
Specific Languages, DSL - embedded in the Scheme language.  The
languages defined through macros can be very different from Scheme;
for instance you can define object oriented languages (object systems
such as <a class="reference" href="../_/https/launchpad.net/r6rs-clos/index.html">TinyCLOS</a> or <a class="reference" href="../_/http/www.barzilay.org/Swindle/index.html">Swindle</a> are typical examples) or even
languages with static typing (the new language <a class="reference" href="../_/http/www.ccs.neu.edu/home/samth/typed-scheme/index.html">Typed Scheme</a>, built
on top of PLT Scheme, is such an example).</p>
<p>In order to address such use cases, Scheme macros
have to be extremely advanced, much more than Lisp macros and any
other kind of macros I know of; as a consequence, they also have a reputation
for complexity. Unfortunately, on top of the intrinsic complexity,
Scheme macros also suffers from accidental complexity, due to history
(there are too many standard macro systems) and to the
tradition of not caring about readability (many Scheme constructs are
made to look more complex than they actually are).</p>
<p>Scheme has two macro systems
included in the <em>de jure</em> standard - <tt class="docutils literal"><span class="pre">syntax-rules</span></tt>,
which allows to define hygienic macros only, and  <tt class="docutils literal"><span class="pre">syntax-case</span></tt>, which
has the full power of Lisp macros and much more - plus a <em>de facto</em> standard
based on <tt class="docutils literal"><span class="pre">define-macro</span></tt> system, which is available
in all implementations and it is well known to everybody because of
its strict similarity to Common Lisp <tt class="docutils literal"><span class="pre">defmacro</span></tt> system.</p>
</div>
<div class="section">
<h1><a id="which-macrology-should-i-teach" name="which-macrology-should-i-teach">Which macrology should I teach?</a></h1>
<p>Since there are so many macro systems it is difficult to decide from where
to start in a pedagogical paper or tutorial.
If you look at the original Italian version of this paper, you will
see that I did talk about <tt class="docutils literal"><span class="pre">syntax-rules</span></tt> macros
first. However, after a lot of thinking, I have decided to go my own
way in this English series of the <em>Adventures</em>.  Here I will not
discuss <tt class="docutils literal"><span class="pre">syntax-rules</span></tt>, nor I will discuss <tt class="docutils literal"><span class="pre">syntax-case</span></tt>: instead,
I will discuss my own version of Scheme macros, which I called
<tt class="docutils literal"><span class="pre">sweet-macros</span></tt>.</p>
<p>Why I am doing that? After all, why my readers should study my own
version of macros when they surely will be better served off by
learning the standard macrology used by everybody? I have spent
<em>years</em> debating with myself this very question, but at the end
I have decided to go this way for a series of reasons:</p>
<ol class="arabic simple">
<li>I regard the existence of two separate macro systems in the same
standard as a wart of Scheme and as a mistake made by the R6RS
editors: they should have included in the language <tt class="docutils literal"><span class="pre">syntax-case</span></tt>
only, leaving <tt class="docutils literal"><span class="pre">syntax-rules</span></tt> as a compatibility library
built on top of <tt class="docutils literal"><span class="pre">syntax-case</span></tt>;</li>
<li>I really don't like the <tt class="docutils literal"><span class="pre">syntax-case</span></tt> syntax, it is by far too
verbose and unreadable; I find there is a strong need for some
sugar on top of it and that is what <tt class="docutils literal"><span class="pre">sweet-macros</span></tt> are for;</li>
<li><tt class="docutils literal"><span class="pre">sweet-macros</span></tt> are very close to <tt class="docutils literal"><span class="pre">syntax-case</span></tt> macros, so
once you understand them you will understand <tt class="docutils literal"><span class="pre">syntax-case</span></tt> too;
from there, understanding <tt class="docutils literal"><span class="pre">syntax-rules</span></tt> is a breeze;</li>
<li>starting from <tt class="docutils literal"><span class="pre">sweet-macros</span></tt> is much better from pedagogical
purposes, especially for readers with a Common Lisp background,
since it is easy to explain the relation with <tt class="docutils literal"><span class="pre">defmacro</span></tt> and
the hygiene issue;</li>
<li>my target readers are programmers coming from the scripting
languages (Perl/Python/Ruby) world. For this kind of public, with
no previous exposition to Scheme, bare <tt class="docutils literal"><span class="pre">syntax-case</span></tt> is
just too hard, so I needed to dress it in nice clothes to make it
palatable;</li>
<li><tt class="docutils literal"><span class="pre">sweet-macros</span></tt> are intended to easier to use than <tt class="docutils literal"><span class="pre">syntax-case</span></tt>
macros, but they are also more powerful, since they provide
introspection and debugging capabilities as well as guarded
patterns, so they should look attractive to
experienced users too; however, this is a nice side effect and not the
main motivation for the library;</li>
<li><tt class="docutils literal"><span class="pre">sweet-macros</span></tt> were written
expressely for this series of papers, since I did not want to litter
my explanation of Scheme macros with endless rants. So, I took
action and I wrote
my own library of macros made "right": this is also a tribute to
the power of Scheme macros, since you can "fix" them from within
the standard macro framework in fifty lines of code.</li>
</ol>
<p>If you are an advanced reader, i.e. a Schemer knowing
<tt class="docutils literal"><span class="pre">syntax-case/syntax-rules</span></tt> or a Lisper knowing <tt class="docutils literal"><span class="pre">defmacro</span></tt>, I a am
sure you will ask yourself what are the differences of
<tt class="docutils literal"><span class="pre">sweet-macros</span></tt> with respect to the system you know.  I will make a
comparison of the various systems in the future, in episode #12 and
later on. For the moment, you will have to wait.  I do not want to
confuse my primary target of readers by discussing other macro systems
right now.  I also defer to episode #12 the delicate question <em>are
macros a good idea?</em>.  For the moment, focus on what macros are and
how you can use them.  Then you will decide if they are a good idea or
not.</p>
</div>
<div class="section">
<h1><a id="enter-sweet-macros" name="enter-sweet-macros">Enter sweet-macros</a></h1>
<p>My <a class="reference" href="../_/http/www.phyast.pitt.edu/~micheles/scheme/sweet-macros.zip">sweet-macros</a> library is a small wrapper
around the <tt class="docutils literal"><span class="pre">syntax-case</span></tt> macro system. I release it
under a liberal BSD licence. You can do whatever you want with it,
just keep the attribution right.</p>
<img alt="../_/http/www.phyast.pitt.edu/~micheles/scheme/pastine-alle-mandorle.jpg" src="../_/http/www.phyast.pitt.edu/~micheles/scheme/pastine-alle-mandorle.jpg">
<p>The primary goal of
<a class="reference" href="../_/http/www.phyast.pitt.edu/~micheles/scheme/sweet-macros.zip">sweet-macros</a> is semplicity, so it only exports three macros,
<tt class="docutils literal"><span class="pre">def-syntax</span></tt>, <tt class="docutils literal"><span class="pre">syntax-match</span></tt> and <tt class="docutils literal"><span class="pre">syntax-expand</span></tt>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">def-syntax</span></tt> is a macro used to define simple macros, which is
similar to <tt class="docutils literal"><span class="pre">defmacro</span></tt>, but simpler and strictly more powerful.</li>
<li><tt class="docutils literal"><span class="pre">syntax-match</span></tt> is a macro used to define complex macro transformers.
It is implemented as a thin layer of sugar on top of <tt class="docutils literal"><span class="pre">syntax-case</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">syntax-expand</span></tt> is a macro which acts as a debugging
facility to expand macros defined via <tt class="docutils literal"><span class="pre">def-syntax</span></tt> or
<tt class="docutils literal"><span class="pre">syntax-match</span></tt>.</li>
</ul>
<p>It should be mentioned that standard Scheme macros do not
provide debugging and/or introspection facilities and that
every implementation provides different means of debugging
macros. This is unfortunate, since <a class="reference" href="../_/http/portal.acm.org/citation.cfm$/id=1289971.1289994.cfm">debugging macros is usually difficult</a>
and it is done often, since it is uncommon to get a
macro right the first time, even if you are an experienced developer.</p>
<p>I wanted to provide my readers with the tools to
understand what they are doing, without relying on the details of the
implementation they are using. Therefore macros defined via <tt class="docutils literal"><span class="pre">syntax-match</span></tt>
(and that includes macros defined via <tt class="docutils literal"><span class="pre">def-syntax</span></tt>) provide out of the box
introspection and debugging features.</p>
<p>Of course, readers who want to rely on the debugging tools of their
implementation can do so; for instance I hear that DrScheme has a
pretty good macro stepper but I have not tried it since I am an
Emacs-addict.</p>
<p>First of all, you should download and install the right sweet-macros library.
Unfortunately the R6RS module system does not really solve the portability
issue (to my endless frustration) so I had to write different versions
of the same library :-( I you are using Ikarus you should download the
single file version of the library</p>
<pre class="literal-block">
$ wget http://www.phyast.pitt.edu/~micheles/scheme/sweet-macros.sls
</pre>
<p>and put it everywhere in you IKARUS_LIBRARY_PATH. If you are using PLT
Scheme (you need a version of PLT newer than 4.0 for R6RS support) you
must download the zip file version</p>
<pre class="literal-block">
$ wget http://www.phyast.pitt.edu/~micheles/scheme/sweet-macros.zip
$ unzip sweet-macros.zip
$ mv sweet-macros &lt;your collects directory&gt;
</pre>
<p>and install it in your <tt class="docutils literal"><span class="pre">collects</span></tt> directory, which on my machine is
<tt class="docutils literal"><span class="pre">$HOME/.plt-scheme/4.0/collects</span></tt>.</p>
<p>Actually, the multifile version of the library works also with Ikarus
if you have a recent enough version (right now I am using the trunk,
version 0.0.3+, revision 1654). I have not tried the library on Larceny;
I have tried it in Ypsilon Scheme which however has a small bug
so that it does not run there (the bug is already fixed in the trunk).
You should always keep in mind than R6RS
implementations are pretty young and that implementors are still working
to make them really compatible.
I have also prepared an R5RS version which should work in Chicken Scheme,
at least in the interpreter:</p>
<pre class="literal-block">
$ wget http://www.phyast.pitt.edu/~micheles/scheme/sweet-macros.scm
</pre>
<p>However I have developed and tested <tt class="docutils literal"><span class="pre">sweet-macros</span></tt> in Ikarus only
(<em>caveat emptor</em>!). Still, since the title of this blog is <em>The Explorer</em>,
I think it is fine if we deal with exploratory code.</p>
<p>You can check that the installation went well by importing the
library:</p>
<pre class="literal-block">
$ ikarus
&gt; (import (sweet-macros))
</pre>
<p>and by trying to define a macro.</p>
</img></div>
<div class="section">
<h1><a id="an-example-multi-define" name="an-example-multi-define">An example: <tt class="docutils literal"><span class="pre">multi-define</span></tt></a></h1>
<p>Here is a <tt class="docutils literal"><span class="pre">multi-define</span></tt> binding construct
which allows to define many identifiers at once:</p>
<pre class="literal-block">
(def-syntax (multi-define (name ...) (value ...))
  #'(begin (define name value) ...))
</pre>
<p>As you see, Scheme macros are based on <a class="reference" href="../_/http/en.wikipedia.org/wiki/Pattern_matching/index.html">pattern matching</a>:
we are giving instructions to the compiler, specifying
how it must acts when it sees certain patterns. In our example,
when the compiler sees a <tt class="docutils literal"><span class="pre">multi-define</span></tt> expression followed by two
sequences with zero o more arguments, it must replace it
with a <tt class="docutils literal"><span class="pre">begin</span></tt> expression containing a sequence of zero or more definitions.
You can check that this is exactly what happens
by means of <tt class="docutils literal"><span class="pre">syntax-expand</span></tt>:</p>
<pre class="literal-block">
&gt; (syntax-expand (multi-define (a b) (1 2)))
(begin (define a 1) (define b 2))
</pre>
<p>Notice that <tt class="docutils literal"><span class="pre">(multi-define</span> <span class="pre">()</span> <span class="pre">())</span></tt> is valid code expanding to a do-nothing
<tt class="docutils literal"><span class="pre">(begin)</span></tt> expression; if you want to reject this corner case, you should
write your macro as</p>
<pre class="literal-block">
(def-syntax (multi-define (name1 name2 ...) (value1 value2 ...))
  #'(begin (define name1 value1) (define name2 value2) ...))
</pre>
<p>so that <tt class="docutils literal"><span class="pre">multi-define</span></tt> requires one or more arguments. However, it is
often useful to accept degenerate corner cases, because they may simplify
automatic code generation (i.e. <tt class="docutils literal"><span class="pre">multi-define</span></tt> could appear in the expansion
of another macro).</p>
<p><tt class="docutils literal"><span class="pre">multi-define</span></tt> works as you would expect:</p>
<pre class="literal-block">
&gt; (multi-define (a b) (1 2)) ; introduce the bindings a=1 and b=2
&gt; a
1
&gt; b
2
</pre>
<p>I have just scratched the surface of Scheme macros here: I leave the
rest for the next episode, don't miss it!</p>
</div>
<h1>Talk Back!</h1>
<p>
Have an opinion?


Readers have already posted

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=240804.html">6

comments</a>
about this weblog entry. Why not

<a href="../_/https/www.artima.com/forums/post.html$/forum=106&amp;thread=240804&amp;reply=true.html">add yours</a>?


<h1>RSS Feed</h1>
<p>
If you'd like to be notified whenever Michele Simionato adds a new entry to <a href="../index.html$/blogger=micheles.html">his weblog</a>, subscribe to his <a href="../feeds/bloggers/micheles.rss">RSS feed</a>.

<center>
<div class="sociallinks">
<a href="../_/http/digg.com/submit$/phase=2&amp;url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D240804&amp;title=The+Adventures+of+a+Pythonista+in+Schemeland%2F9&amp;bodytext=This+episode+is+entirely+devoted+to+Scheme+macros+from+a+personal+point+of+view.+Pattern+matching+is+introduced+as+the+fundamental+mechanism+on+which+macros%0D%0Aare+built.&amp;topic=programming">
<img alt="Digg" border="0" height="14" hspace="8" src="../_/https/www.artima.com/images/digg.gif" width="16">Digg
  </img></a>
  |
  <a href="../_/http/del.icio.us/post$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D240804&amp;title=The+Adventures+of+a+Pythonista+in+Schemeland%2F9">
<img alt="del.icio.us" border="0" height="16" hspace="8" src="../_/https/www.artima.com/images/delicious.gif" vspace="1" width="16"/>del.icio.us
  </a>
  |
  <a href="../_/http/programming.reddit.com/submit$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D240804&amp;title=The+Adventures+of+a+Pythonista+in+Schemeland%2F9">
<img alt="Reddit" border="0" height="18" hspace="8" src="../_/https/www.artima.com/images/reddit.gif" width="18"/>Reddit
  </a>
</div>
</center>
<h1>About the Blogger</h1>
<p>
<table><tr valign="bottom"><td><img align="right" src="../_/https/www.artima.com/images/micheleSimionato.jpg"/></td><td>Michele Simionato started his career as a Theoretical Physicist, working in Italy, France and the U.S. He turned to programming in 2003; since then he has been working professionally as a Python developer and now he lives in Milan, Italy. Michele is well known in the Python community for his posts in the newsgroup(s), his articles and his Open Source libraries and recipes. His interests include object oriented programming, functional programming, and in general programming metodologies that enable us to manage the complexity of modern software developement.</td></tr></table><p>
<div class="sp">This weblog entry is Copyright © 2008 Michele Simionato. All rights reserved.</div>
</p></p></p></p></p></div>

<hr width="100%">
<table align="center" width="50%">
<tr>
<td>
<div class="horizontaltextadbox">
<div class="adheadline">Sponsored Links</div>
<div id="sponsoredlinks">
</div>
</div>
</td>
</tr>
</table>
<hr width="100%"/>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3911176865765226";
google_alternate_color = "ffffff";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "003090";
google_color_text = "000000";
google_color_url = "666666";
//--></script>
<script src="../_/https/pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<br>
<br/>
<!-- SiteSearch Google -->
<form action="../_/https/www.google.com/custom/index.html" method="get">
<table bgcolor="#ffffff" border="0">
<tr><td align="left" height="32" nowrap="nowrap" valign="top">
<a href="../_/https/www.google.com/index.html">
<img alt="Google" border="0" src="../_/https/www.google.com/logos/Logo_25wht.gif"/></a>
</td>
<td nowrap="nowrap">
<input name="domains" type="hidden" value="Artima.com"/>
<input maxlength="255" name="q" size="31" type="text" value=""/>
<input name="sa" type="submit" value="Search"/>
</td></tr>
<tr>
<td> </td>
<td nowrap="nowrap">
<font color="#000000" size="-1">
<input name="sitesearch" type="radio" value=""/> Web
<input checked="checked" name="sitesearch" type="radio" value="Artima.com"/>Artima.com
</font>  
<input name="client" type="hidden" value="pub-3911176865765226"/>
<input name="forid" type="hidden" value="1"/>
<input name="ie" type="hidden" value="ISO-8859-1"/>
<input name="oe" type="hidden" value="ISO-8859-1"/>
<input name="cof" type="hidden" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:FFFFFF;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:150;L:https://www.artima.com/images/artima150.gif;S:https://www.artima.com;FORID:1;"/>
<input name="hl" type="hidden" value="en"/>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</br></center>
<br/>
<div class="sp">
<div style="text-align: center;">
<a href="../_/https/www.artima.com/copyright.html">Copyright</a> © 1996-2019 Artima, Inc. All Rights Reserved. - <a href="../_/https/www.artima.com/privacy.html">Privacy Policy</a> - <a href="../_/https/www.artima.com/termsofuse.html">Terms of Use</a>
</div>
</div>
<br/>
<script language="JavaScript" type="text/javascript">
<!--
function initBannerVarForZone(zone) {
        initBannerVarForZoneWithScript(zone, 'adjs_modified');
}

function initBannerVarForZoneWithScript(zone, phpScript) {

        if (!document.phpAds_used) document.phpAds_used = ',';
        phpAds_random = new String (Math.random());
        phpAds_random = phpAds_random.substring(2,11);

        var nextScriptSrc = '../_/https/www.artima.com/zcr/index.html' + phpScript + '.php?n=' +
                phpAds_random  +
                '&amp;what=zone:' + zone + '&amp;target=_top&amp;block=1&amp;blockcampaign=1' +
                '&amp;exclude=' + document.phpAds_used;

        document.write("<script language='JavaScript' type='text/javascript' src='");
        document.write(nextScriptSrc);
        document.write("'><\/script>");

}

function replaceDiv(divID) {
        document.getElementById(divID).innerHTML = phpadsbanner;
}
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZone(3);
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('leftskyscraper');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZoneWithScript(4, 'textman');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('sponsoredlinks');
-->
</script>
</hr><a href="https://dafoster.net/projects/crystal-web-archiver/" id="cr-footer-banner" style="border-top: 2px #B40010 solid;background: #FFFAE1;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-variant: initial;font-weight: initial;text-transform: none;font-size: 14px;color: #6c757d;line-height: 2.0;cursor: pointer;display: flex;align-items: center;justify-content: center;gap: 4px;clear: both;" target="_blank"><img height="24" onerror="this.style['display'] = 'none';" src="../_/crystal/resources/appicon.png" width="24"/><span>This page was archived with Crystal</span><script>window.addEventListener('load', function() { const $1 = document.querySelector('#cr-footer-banner'); if (!$1) { return; } if (window !== window.top) { let $2 = false; if (window.name) { const $3 = window.parent.document.getElementsByName(window.name); if ($3.length === 1) { const $4 = $3[0]; if ($4.tagName === 'FRAME' && $4.parentElement.tagName === 'FRAMESET') { let $5 = $4; while (true) { if ($5.parentElement.tagName !== 'FRAMESET') { $2 = true; break; } if ($5.parentElement.attributes['rows'] !== undefined) { const $6 = $5.parentElement.children; if ($5 === $6[$6.length - 1]) { $5 = $5.parentElement; continue; } else { break; } } else if ($5.parentElement.attributes['cols'] !== undefined) { const $7 = Array.from($5.parentElement.children); const $8 = $7.indexOf($5); if ($8 === -1) { break; } const $9 = $5.parentElement.attributes['cols'].value.split(','); const $10 = $9.map((s) => parseInt(s.trim())); if ($9[$8].trim() === '*' || $10[$8] === Math.max.apply(null, $10)) { $5 = $5.parentElement; continue; } else { break; } } else { break; } } } } } if (!$2) { $1.style['display'] = 'none'; } } const $11 = $1.getBoundingClientRect(); const $12 = ($11.y < window.innerHeight - $11.height); if ($12) { $1.style['position'] = 'fixed'; $1.style['bottom'] = '0'; $1.style['left'] = '0'; $1.style['right'] = '0'; $1.style['z-index'] = '9999'; } const $13 = ( document.body.getBoundingClientRect().height < $11.height * 2 ); if ($13) { $1.style['display'] = 'none'; }
});</script></a></body>
</html>
