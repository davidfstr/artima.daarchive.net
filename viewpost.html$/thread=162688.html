
<!DOCTYPE html>

<html>
<head><meta content="noindex,nofollow" name="robots"/>
<title>Java desktop drag and drop</title>
<meta charset="utf-8"/>
<meta content="Gregg Wonderly" name="author">
<link href="../_/https/www.artima.com/artima.css" rel="stylesheet" type="text/css"/>
<link href="../_/https/www.artima.com/favicon.ico" rel="shortcut icon"/>
</meta></head>
<body><table cellspacing="0" width="100%">
<tr>
<td align="left" valign="bottom">
<a href="../_/https/www.artima.com/index.html"><img alt="The Artima Developer Community" border="0" height="43" src="../_/https/www.artima.com/images/a7.gif" width="550"/></a>
</td>
</tr></table>
<table bgcolor="#333333" width="100%">
<tr>
<td align="center">
<div class="ml">
<a class="hl" href="../_/https/www.artima.com/articles/index.html">Articles</a> |
<a class="hl" href="../_/https/www.artima.com/news/index.html">News</a> |
<a class="hl" href="../index.html">Weblogs</a> |
<a class="hl" href="../_/https/www.artima.com/shop/catalog/index.html">Books</a> |
<a class="hl" href="../_/https/www.artima.com/forums/index.html">Forums</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#FFCC99" width="100%">
<tr>
<td align="center">
<div class="sc">
<a href="../index.html">Artima Weblogs</a> | 

<a href="../index.html$/blogger=greggwon.html">Gregg Wonderly's Weblog</a> | 

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=162688.html">Discuss</a> | 
<a href="mailto:?subject=Java desktop drag and drop&amp;body= %0AArtima Weblogs %0AJava desktop drag and drop %0Aby Gregg Wonderly %0A%0Ahttps://www.artima.com/weblogs/viewpost.jsp?thread=162688">Email</a> | 
<a href="../viewpostP.html$/thread=162688.html">Print</a> | 
<a href="../bloggers.html">Bloggers</a> | 
<a class="sl" href="thread=155167.html" title="It's time for a new Java I/O API">Previous</a> | 
<a class="sl" href="thread=175214.html" title="Netbeans Module for JMX enabling your application">Next</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#EEEEEE" width="100%">
<tr>
<td align="center">
<div class="sc">
<span style="color: #555555;">Sponsored Link</span> <span style="color: #888888;">•</span>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
   if (!document.phpAds_used) document.phpAds_used = ',';
   phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
   
   document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
   document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
   document.write ("&amp;what=zone:9&amp;target=_top");   document.write ("&amp;exclude=" + document.phpAds_used);
   if (document.referrer)
      document.write ("&amp;referer=" + escape(document.referrer));
   document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a799ecf6.html" target="_top"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:9&amp;n=a0587811.html"/></a></noscript>
</div>
</td>
</tr>
</table>
<br/>
<div class="vegies">
<div class="tc">
<span class="sts">Software and Return on Investment</span><br>
<span class="ts">Java desktop drag and drop</span><br/>
<span class="as">by Gregg Wonderly</span><br/>
<span class="pd">June 1, 2006</span><br/>
</br></div>
<blockquote>
<b>Summary</b><br/>
There are several different things about desktop drag and drop that are interesting.  I've been using several things in my JiniDesktop class in my http://startnow.dev.java.net project.  Here's an extracted example of all the pieces.

</blockquote>
<hr align="left" width="90%"/>
<table align="right">
<tr>
<td>
<div class="adnotice">
Advertisement
</div>
<center>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
if (!document.phpAds_used) document.phpAds_used = ',';
phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
document.write ("&amp;what=zone:2");
document.write ("&amp;exclude=" + document.phpAds_used);
if (document.referrer)
document.write ("&amp;referer=" + escape(document.referrer));
document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a74ab060.html" target="_blank"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:2&amp;n=a74ab060.html"/></a></noscript>
</center>
</td>
</tr>
</table>
<p>
When creating a drag and drop desktop like you'd find on a desktop computing environment, there are several interesting things to tend to.  I've been working through these issues in my <a href="../_/http/startnow.dev.java.net/index.html">JiniDesktop</a> application.  This application looks for all <a href="../_/http/serviceui.jini.org/index.html">ServiceUI</a> enabled Jini services, and then enumerates them into a tree structure for access.
<p>
You can drag the service names out of the tree structure and place them on a desktop which you can then arrange by dragging the icons around.  I used a JLayeredPane to make the drag operations be layered on top of the static operations more easily.
<p>
My JDesktopItem class buried inside of the JiniDesktop class has much more too it then shown here, including some different class structure.  I extracted the parts that I thought would be the most interesting and have included them below.
<h2>The DeskItem class</h2>
I used JLabel as the parent class so that I could also associate an Icon with the text of the service name.  I haven't included support or use of Icons here to simplify the visible code.
<p>
I'm just going to include all of the code here for now, and my follow up with some point by point discussion if anyone is interested.  There are two classes here, if you put them into the appropriately named files, adding the necessary imports, you should be able to compile them.  Run the DeskExample class and you'll see how the draging on the desktop works including hover control and selection highlighting.
<p>
I used gradient drawing to make everything look fancy.  You can, of course do some different things with the drawing.
<pre>
public class DeskItem extends JLabel {
    /**
     * The original UI that we revert to when not selected, hovered or otherwise active.
     */
    private ComponentUI oldUI;
    /**
     * Is this DeskItem in a selected state?
     */
    protected boolean selected;
    /**
     * The JLayeredPane we are on, if any.
     */
    private JLayeredPane pane;
    /**
     * The MouseMotionListener created to manage our drag state.
     */
    private MyMouseMotionListener mml;
    
    /**
     * The ComponentUI used for normal rendering.
     */
    protected static MyUI myui = new MyUI();
    /**
     * The ComponentUI used for active rendering (hover).
     */
    protected static MyUI actui = new MyUI( new Color( 255, 205, 215) );
    /**
     * The ComponentUI used for selected state.
     */
    protected static MyUI selui = new MyUI( new Color( 230, 230, 255 ) );
    /**
     * The ComponentUI used for selected and active rendering (hover).
     */
    protected static MyUI selactui = new MyUI( new Color( 180, 180, 255 ) );
    /**
     * Should gradient rendering be down at all?
     */
    protected static boolean gradients = true;
    /**
     * The last DeskItem that was selected.
     */
    private static DeskItem lastItem;
    /**
     * The current, active DeskItem.
     */
    private static DeskItem curItem;
    /**
     * Logger for this class
     */
    private static Logger log = Logger.getLogger( DeskItem.class.getName() );

    /**
     * Activates all the mouse listening activities
     */
    private void mouseEntry() {
        addMouseListener( new MouseAdapter() {
            public void mouseEntered( MouseEvent ev ) {
                if( gradients ) {
                    setUI( selected ? selactui : actui );
                    setOpaque(true);
                }
                repaint();
            }
            public void mouseExited( MouseEvent ev ) {
                if( gradients ) {
                    setUI( selected ? selui : myui );
                    setOpaque(selected);
                }
                repaint();
            }
        });
        addMouseListener( new MyMouseAdapter() );
    }
    
    /**
     * Used to deselect the last selected DeskItem so that none are active.  This can
     * be called when the background of the desk is clicked on, or some other focus
     * change event.
     */
    public static synchronized void clearSelection() {
        if( lastItem != null ) {
            lastItem.exit();
        }
        lastItem = null;
    }

    /**
     * This is called when the item is double clicked on.  A subclass can provide an
     * action here.
     */
    public void invoke() {
    }
    
    /**
     * Called to report exception encountered during processing of events.
     * @param ex The Exception to report.
     */
    protected void reportException( Exception ex ) {
        log.log( Level.SEVERE, ex.toString(), ex );
    }
    /**
     * Make the selectable object bigger to surround the text 
     * with coloring.
     */
    protected void setBorder() {

        setBorder( BorderFactory.createEmptyBorder( 5,5,5,5));    
    }
    /**
     * Creates a DeskItem that is on a JLayeredPane with the passed String identifier.
     * @param pane The JLayeredPane that the item will be placed on.
     * @param label The Label string to use.
     */
    public DeskItem( JLayeredPane pane, String label ) {
        super(label);
        this.pane = pane;
        oldUI = getUI();
        if( gradients )
            setUI( myui );
        mouseEntry();
    }

    /**
     * Constructs a DeskItem that won't be placed on a JLayeredPane.
     * @param label The String label for this item
     */
    public DeskItem( String label ) {
        super(label);
        oldUI = getUI();
        if( gradients )
            setUI( myui );
        mouseEntry();
    }

    /**
     * Called when the mouse enters this DeskItem.
     */
    protected void enter() {
        selected = true;
        if( gradients ) {
            setUI( selui );
        }
        setOpaque( true );
        repaint();
        curItem = this;
    }

    /**
     * Called when the mouse exits this DeskItem.
     */
    protected void exit() {
        curItem = null;
        selected = false;
        setOpaque( false );
        repaint();
    }

    /**
     * Called when the user performs a context menu click using the popup trigger button/operation
     * associated with the component.
     * <p>
     * Subclasses can override this method to provide an operation.
     * 
     * @param ev The associated mouse event to get the context from.
     */
    protected void popup( MouseEvent ev ) {
    }

    /**
     * The MouseAdapter that handles click events to establish the MouseMotionListener.
     */
    private class MyMouseAdapter extends MouseAdapter {
        /**
         * The item this listener is associated with.
         */
        DeskItem item;

        /**
         * Creates an instance.
         */
        public MyMouseAdapter() {
            this.item = DeskItem.this;
        }

        /**
         * Called when the user clicks on the DeskItem.
         * @param ev The event associated with the click operation.
         */
        public void mouseClicked( MouseEvent ev ) {
            if( ev.getClickCount() == 2 &amp;&amp; ev.getButton() == 1 ) {
                log.finer("Invoking: "+DeskItem.this);
                try {
                    // Invoke the item to process any action.
                    item.invoke();
                } catch( Exception ex ) {
                    reportException(ex);
                }
            }
        }

        /**
         * Called when the mouse is pressed down.
         * @param ev The associated event.
         */
        public void mousePressed( MouseEvent ev ) {
            // Check if popup
            if( ev.isPopupTrigger() ) {
                // switch selected to this item
                if( lastItem != DeskItem.this ) {
                    lastItem.exit();
                }
                lastItem = DeskItem.this;
                lastItem.enter();
                
                // Show the menu if any
                popup(ev);
                return;
            }
            
            // Not popup, so clear last selected
            if( lastItem != null ) {
                lastItem.exit();
            }
            
            // If not button 1, just ignore
            if( ev.getButton() != 1 )
                return;
            
            // Activate motion listener and what for drag.
            createMotionListener(ev);
            
            // Add the mouse listener created, or already existing.
            DeskItem.this.addMouseMotionListener(mml);
        }

        /**
         * called to create the MouseMotionListener when the drag operation starts.
         * @param ev The associated mouse event.
         */
        private void createMotionListener(MouseEvent ev) {
            lastItem = DeskItem.this;
            lastItem.enter();
            Point p = lastItem.getLocation();
            final int offx = ev.getX();
            final int offy = ev.getY();

            // Create new listener as needed
            if( mml == null ) {
                mml = new MyMouseMotionListener();
            }

            // Set drag offsets into object
            mml.setOffsets( offx, offy );
        }

        /**
         * Called when the mouse button is released.
         * @param ev The associated event.
         */
        public void mouseReleased( MouseEvent ev ) {

            if( ev.isPopupTrigger() ) {
                // Make sure the correct last item is identified.
                if( lastItem != null &amp;&amp; lastItem != DeskItem.this ) {
                    lastItem.exit();
                }

                lastItem = DeskItem.this;
                lastItem.enter();
                popup(ev);

                // Stop listening to mouse motion events.
                if( mml != null )
                    DeskItem.this.removeMouseMotionListener(mml);
                return;
            }

            // Not popup, remove motion listener
            DeskItem.this.removeMouseMotionListener(mml);

            // When dropped, move back to the default layer.
            if( pane != null ) {
                pane.setLayer( DeskItem.this, 
                    JLayeredPane.DEFAULT_LAYER.intValue(), 0 );
            }
        }
    }

    /**
     * The MouseMotionAdapter used to track the drag operation.
     */
    private class MyMouseMotionListener extends MouseMotionAdapter {
        /**
         * The x offset of the initial mouse click from the left edge of the DeskItem.
         */
        int offx;
        /**
         * The y offset of the mouse from the top of the DeskItem
         */
        int offy;
        /**
         * updates the current offsets for each successive drag operation to the click point that the
         * mouse was out when the mouse was pressed.
         * @param x The X location of the initial mouse down event.
         * @param y The Y location of the initial mouse down event.
         */
        public void setOffsets(int x, int y ) {
            offx = x;
            offy = y;
        }
        /**
         * Called when the mouse is moved without a button down.
         * @param ev The associated event for this operation.
         */
        public void mouseMoved( MouseEvent ev ) {
            mouseDragged(ev);
        }
        /**
         * Called when the mouse is moved with button one down.
         * @param ev The associated mouse event.
         */
        public void mouseDragged( MouseEvent ev ) {
            Point pt = getLocation();
            Point p = new Point( ev.getX()+pt.x-offx,
                ev.getY()+pt.y-offy);

            // Positioning is every 5 pixels to make it easier to line things up.
            int xoff = p.x % 5;
            int yoff = p.y % 5;

            p = new Point( p.x-xoff+5, p.y-yoff+5);

            // On a JDesktopPane, change the layer so that
            // we pass over everything on the desktop
            if( pane != null ) {
                pane.setLayer( DeskItem.this,
                    JLayeredPane.DRAG_LAYER.intValue() );
            }

            setLocation( p.x, p.y );
        }
    }
    
    /**
     * The UI used to control the drawing of the DeskItem without having to conditionalize
     * the paint operations.
     */
    private static class MyUI extends com.sun.java.swing.plaf.windows.WindowsLabelUI {
        /**
         * The color of the background.
         */
        Color col;
        /**
         * Constructs an instance with the default coloring using the default background color
         * associated with the look and feel.
         */
        public MyUI() {
            col = new JLabel().getBackground();
        }
        /**
         * Constructs and instance using the passed color for the background.
         * @param c The color to use for the background painting operations.
         */
        public MyUI( Color c ) {
            col = c;
        }
        /**
         * Called to perform the paint operation on the passed component.
         * @param g The graphics context for the paint operation.
         * @param c The component to paint into the graphics environment.
         */
        public void update(Graphics g, JComponent c) {
            if( !gradients ) {
                super.update( g, c );
                return;
            }
            if (c.isOpaque()) {
                Graphics2D g2 = (Graphics2D)g;
                Paint pt = g2.getPaint();
                g2.setPaint( new GradientPaint( c.getWidth(), 0, col.darker(),
                    c.getWidth(), c.getHeight(), col ) );
                g.fillRoundRect(0, 0, c.getWidth(),c.getHeight(), 5, 5 );
                g2.setPaint( pt );
            }
            super.paint(g, c);
        }
    }
}
</p></pre>
<h2>The DeskExample class</h2>
This is the main class which provides the example desktop with some DeskItems on it.
Drag them around and see how it all works.
<p>
<pre>
public class DeskExample  {
    Logger log = Logger.getLogger( getClass().getName() );
    public static void main( String args[] ) {
        new DeskExample();
    }
    
    /** Creates a new instance of DeskExample */
    public DeskExample() {
        JFrame f = new JFrame("Example desktop dragging");
        JDesktopPane pane = new JDesktopPane() {
            // Use the background color of a known component.
            Color col = new Color( 200, 235, 210 );

            public void paintComponent( Graphics g ) {
                Graphics2D g2 = (Graphics2D)g;
                Paint pt = g2.getPaint();
                int w = getSize().width;
                int h = getSize().height;
                g2.setPaint( new GradientPaint( w/4, h/2, col.brighter(),
                    w, h, col.darker() ) );
                g2.fillRect( 0, 0, w, h );
                g2.setPaint( pt );
            }
        };
        pane.setOpaque( true );
        Packer pk = new Packer( f.getContentPane() );
        pk.pack( pane ).fillboth();
        for( int i = 0; i &lt; 10; ++i ) {
            DeskItem item = new DeskItem( pane, "Item #"+i );
            log.info("adding item: "+item);
            pane.add( item );
            pane.setLayer( item, JLayeredPane.DEFAULT_LAYER.intValue() );
            item.setLocation( 10, i*30 );
            item.setVisible(true);
            item.setSize( item.getPreferredSize() );
            item.setForeground( Color.black );
        }
        f.pack();
        f.setSize( 400, 300 );
        f.setLocationRelativeTo( null );
        f.addWindowListener( new WindowAdapter() {
            public void windowClosing( WindowEvent ev ) {
                System.exit(1);
            }
        });
        f.setVisible( true );
    }
}
</pre>
<h1>Talk Back!</h1>
<p>
Have an opinion?


Readers have already posted

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=162688.html">2

comments</a>
about this weblog entry. Why not

<a href="../_/https/www.artima.com/forums/post.html$/forum=106&amp;thread=162688&amp;reply=true.html">add yours</a>?


<h1>RSS Feed</h1>
<p>
If you'd like to be notified whenever Gregg Wonderly adds a new entry to <a href="../index.html$/blogger=greggwon.html">his weblog</a>, subscribe to his <a href="../feeds/bloggers/greggwon.rss">RSS feed</a>.

<center>
<div class="sociallinks">
<a href="../_/http/digg.com/submit$/phase=2&amp;url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D162688&amp;title=Java+desktop+drag+and+drop&amp;bodytext=There+are+several+different+things+about+desktop+drag+and+drop+that+are+interesting.++I%27ve+been+using+several+things+in+my+JiniDesktop+class+in+my+http%3A%2F%2Fstartnow.dev.java.net+project.++Here%27s+an+extracted+example+of+all+the+pieces.&amp;topic=programming">
<img alt="Digg" border="0" height="14" hspace="8" src="../_/https/www.artima.com/images/digg.gif" width="16">Digg
  </img></a>
  |
  <a href="../_/http/del.icio.us/post$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D162688&amp;title=Java+desktop+drag+and+drop">
<img alt="del.icio.us" border="0" height="16" hspace="8" src="../_/https/www.artima.com/images/delicious.gif" vspace="1" width="16">del.icio.us
  </img></a>
  |
  <a href="../_/http/programming.reddit.com/submit$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D162688&amp;title=Java+desktop+drag+and+drop">
<img alt="Reddit" border="0" height="18" hspace="8" src="../_/https/www.artima.com/images/reddit.gif" width="18"/>Reddit
  </a>
</div>
</center>
<h1>About the Blogger</h1>
<p>
<table><tr valign="bottom"><td><img align="right" src="../_/https/www.artima.com/images/gregg.jpg"/></td><td>Gregg Wonderly graduated from Oklahoma State University in 1988 with an MS in COMSCI.  His areas of concentration include Operating Systems and Languages.  His first job was at the AT&amp;T Bell Labs facilities in Naperville IL working on software retrofit for the 5ESS switch.  He designed a procedure control language in the era of the development of Java with similar motivations that the Oak and then Java language development was driven by.  Language design is still at the top of his list, but his focus tends to be on application languges layered on top of programming languages such as Java.  Some just consider this API design, but there really is more to it!  Gregg now works for Cyte Technologies Inc., where he does software engineering and design related to distributed systems in highly available environments.</td></tr></table><p>
<div class="sp">This weblog entry is Copyright © 2006 Gregg Wonderly. All rights reserved.</div>
</p></p></p></p></p></p></p></p></p></p></div>

<hr width="100%">
<table align="center" width="50%">
<tr>
<td>
<div class="horizontaltextadbox">
<div class="adheadline">Sponsored Links</div>
<div id="sponsoredlinks">
</div>
</div>
</td>
</tr>
</table>
<hr width="100%"/>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3911176865765226";
google_alternate_color = "ffffff";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "003090";
google_color_text = "000000";
google_color_url = "666666";
//--></script>
<script src="../_/https/pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<br>
<br/>
<!-- SiteSearch Google -->
<form action="../_/https/www.google.com/custom/index.html" method="get">
<table bgcolor="#ffffff" border="0">
<tr><td align="left" height="32" nowrap="nowrap" valign="top">
<a href="../_/https/www.google.com/index.html">
<img alt="Google" border="0" src="../_/https/www.google.com/logos/Logo_25wht.gif"/></a>
</td>
<td nowrap="nowrap">
<input name="domains" type="hidden" value="Artima.com"/>
<input maxlength="255" name="q" size="31" type="text" value=""/>
<input name="sa" type="submit" value="Search"/>
</td></tr>
<tr>
<td> </td>
<td nowrap="nowrap">
<font color="#000000" size="-1">
<input name="sitesearch" type="radio" value=""/> Web
<input checked="checked" name="sitesearch" type="radio" value="Artima.com"/>Artima.com
</font>  
<input name="client" type="hidden" value="pub-3911176865765226"/>
<input name="forid" type="hidden" value="1"/>
<input name="ie" type="hidden" value="ISO-8859-1"/>
<input name="oe" type="hidden" value="ISO-8859-1"/>
<input name="cof" type="hidden" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:FFFFFF;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:150;L:https://www.artima.com/images/artima150.gif;S:https://www.artima.com;FORID:1;"/>
<input name="hl" type="hidden" value="en"/>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</br></center>
<br/>
<div class="sp">
<div style="text-align: center;">
<a href="../_/https/www.artima.com/copyright.html">Copyright</a> © 1996-2019 Artima, Inc. All Rights Reserved. - <a href="../_/https/www.artima.com/privacy.html">Privacy Policy</a> - <a href="../_/https/www.artima.com/termsofuse.html">Terms of Use</a>
</div>
</div>
<br/>
<script language="JavaScript" type="text/javascript">
<!--
function initBannerVarForZone(zone) {
        initBannerVarForZoneWithScript(zone, 'adjs_modified');
}

function initBannerVarForZoneWithScript(zone, phpScript) {

        if (!document.phpAds_used) document.phpAds_used = ',';
        phpAds_random = new String (Math.random());
        phpAds_random = phpAds_random.substring(2,11);

        var nextScriptSrc = '../_/https/www.artima.com/zcr/index.html' + phpScript + '.php?n=' +
                phpAds_random  +
                '&amp;what=zone:' + zone + '&amp;target=_top&amp;block=1&amp;blockcampaign=1' +
                '&amp;exclude=' + document.phpAds_used;

        document.write("<script language='JavaScript' type='text/javascript' src='");
        document.write(nextScriptSrc);
        document.write("'><\/script>");

}

function replaceDiv(divID) {
        document.getElementById(divID).innerHTML = phpadsbanner;
}
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZone(3);
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('leftskyscraper');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZoneWithScript(4, 'textman');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('sponsoredlinks');
-->
</script>
</hr><a href="https://dafoster.net/projects/crystal-web-archiver/" id="cr-footer-banner" style="border-top: 2px #B40010 solid;background: #FFFAE1;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-variant: initial;font-weight: initial;text-transform: none;font-size: 14px;color: #6c757d;line-height: 2.0;cursor: pointer;display: flex;align-items: center;justify-content: center;gap: 4px;clear: both;" target="_blank"><img height="24" onerror="this.style['display'] = 'none';" src="../_/crystal/resources/appicon.png" width="24"/><span>This page was archived with Crystal</span><script>window.addEventListener('load', function() { const $1 = document.querySelector('#cr-footer-banner'); if (!$1) { return; } if (window !== window.top) { let $2 = false; if (window.name) { const $3 = window.parent.document.getElementsByName(window.name); if ($3.length === 1) { const $4 = $3[0]; if ($4.tagName === 'FRAME' && $4.parentElement.tagName === 'FRAMESET') { let $5 = $4; while (true) { if ($5.parentElement.tagName !== 'FRAMESET') { $2 = true; break; } if ($5.parentElement.attributes['rows'] !== undefined) { const $6 = $5.parentElement.children; if ($5 === $6[$6.length - 1]) { $5 = $5.parentElement; continue; } else { break; } } else if ($5.parentElement.attributes['cols'] !== undefined) { const $7 = Array.from($5.parentElement.children); const $8 = $7.indexOf($5); if ($8 === -1) { break; } const $9 = $5.parentElement.attributes['cols'].value.split(','); const $10 = $9.map((s) => parseInt(s.trim())); if ($9[$8].trim() === '*' || $10[$8] === Math.max.apply(null, $10)) { $5 = $5.parentElement; continue; } else { break; } } else { break; } } } } } if (!$2) { $1.style['display'] = 'none'; } } const $11 = $1.getBoundingClientRect(); const $12 = ($11.y < window.innerHeight - $11.height); if ($12) { $1.style['position'] = 'fixed'; $1.style['bottom'] = '0'; $1.style['left'] = '0'; $1.style['right'] = '0'; $1.style['z-index'] = '9999'; } const $13 = ( document.body.getBoundingClientRect().height < $11.height * 2 ); if ($13) { $1.style['display'] = 'none'; }
});</script></a></body>
</html>
