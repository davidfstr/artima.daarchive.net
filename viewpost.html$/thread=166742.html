
<!DOCTYPE html>

<html>
<head><meta content="noindex,nofollow" name="robots"/>
<title>In Defense of Pattern Matching</title>
<meta charset="utf-8"/>
<meta content="Martin Odersky" name="author">
<link href="../_/https/www.artima.com/artima.css" rel="stylesheet" type="text/css"/>
<link href="../_/https/www.artima.com/favicon.ico" rel="shortcut icon"/>
</meta></head>
<body><table cellspacing="0" width="100%">
<tr>
<td align="left" valign="bottom">
<a href="../_/https/www.artima.com/index.html"><img alt="The Artima Developer Community" border="0" height="43" src="../_/https/www.artima.com/images/a7.gif" width="550"/></a>
</td>
</tr></table>
<table bgcolor="#333333" width="100%">
<tr>
<td align="center">
<div class="ml">
<a class="hl" href="../_/https/www.artima.com/articles/index.html">Articles</a> |
<a class="hl" href="../_/https/www.artima.com/news/index.html">News</a> |
<a class="hl" href="../index.html">Weblogs</a> |
<a class="hl" href="../_/https/www.artima.com/shop/catalog/index.html">Books</a> |
<a class="hl" href="../_/https/www.artima.com/forums/index.html">Forums</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#CCCCCC" width="100%">
<tr>
<td align="center">
<div class="sc">
<a href="../index.html">Artima Weblogs</a> | 

<a href="../index.html$/blogger=modersky.html">Martin Odersky's Weblog</a> | 

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=166742.html">Discuss</a> | 
<a href="mailto:?subject=In Defense of Pattern Matching&amp;body= %0AArtima Weblogs %0AIn Defense of Pattern Matching %0Aby Martin Odersky %0A%0Ahttps://www.artima.com/weblogs/viewpost.jsp?thread=166742">Email</a> | 
<a href="../viewpostP.html$/thread=166742.html">Print</a> | 
<a href="../bloggers.html">Bloggers</a> | 
<a class="sl" href="thread=163733.html" title="A Brief History of Scala">Previous</a> | 
<a class="sl" href="thread=168839.html" title="Pattern Matching Wrap-Up">Next</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#EEEEEE" width="100%">
<tr>
<td align="center">
<div class="sc">
<span style="color: #555555;">Sponsored Link</span> <span style="color: #888888;">•</span>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
   if (!document.phpAds_used) document.phpAds_used = ',';
   phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
   
   document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
   document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
   document.write ("&amp;what=zone:9&amp;target=_top");   document.write ("&amp;exclude=" + document.phpAds_used);
   if (document.referrer)
      document.write ("&amp;referer=" + escape(document.referrer));
   document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a799ecf6.html" target="_top"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:9&amp;n=a0587811.html"/></a></noscript>
</div>
</td>
</tr>
</table>
<br/>
<div class="vegies">
<div class="tc">
<span class="sts">Ideas, Languages, and Programs</span><br>
<span class="ts">In Defense of Pattern Matching</span><br/>
<span class="as">by Martin Odersky</span><br/>
<span class="pd">June 29, 2006</span><br/>
</br></div>
<blockquote>
<b>Summary</b><br/>
Pattern matching is much maligned by object-oriented programmers. I wonder why?

</blockquote>
<hr align="left" width="90%"/>
<table align="right">
<tr>
<td>
<div class="adnotice">
Advertisement
</div>
<center>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
if (!document.phpAds_used) document.phpAds_used = ',';
phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
document.write ("&amp;what=zone:2");
document.write ("&amp;exclude=" + document.phpAds_used);
if (document.referrer)
document.write ("&amp;referer=" + escape(document.referrer));
document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a74ab060.html" target="_blank"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:2&amp;n=a74ab060.html"/></a></noscript>
</center>
</td>
</tr>
</table>
<p>
<p>As I wrote <a class="reference" href="../_/http/www.artima.com/weblogs/viewpost.html$/thread=163733.html">before</a>, <a class="reference" href="../_/http/scala.epfl.ch/index.html">Scala</a> aims to unify object-oriented and functional
programming. When people talk about functional programming, they
usually mean one of two different things: In the <em>exclusive</em> sense,
functional means no side-effects. In the <em>inclusive sense</em> it means a
programming style which composes functions in interesting ways. When I
talk about functional programming, I usually mean it in the inclusive
sense.</p>
<p>A number of language constructs are called functional because they are
used a lot in functional languages or because they first appeared in a
functional language. Three such features are:</p>
<blockquote>
<ul class="simple">
<li>functions as first-class values</li>
<li>parameterized types</li>
<li>pattern matching</li>
</ul>
</blockquote>
<p>When I talk to many advocates of object-oriented programming, they
readily embrace the first two. After all, functions as first-class
values are also found in Smalltalk (where they are called blocks),
Python, or Ruby.  The next version of C# is going to have them, and I
would not be surprised if a future version of Java also acquired
them. Parameterized types are also very common, with variations such
as C++ templates, or the generics of Eiffel, Java 1.5 or C# 2.0. But
when I propose pattern matching, I get violent outbursts of
rejection. The arguments against are usually a permutation of:</p>
<blockquote>
<ol class="arabic simple">
<li>Pattern matching is unnecessary, just use the <a class="reference" href="../_/http/en.wikipedia.org/wiki/Visitor_pattern/index.html">visitor design pattern</a>.</li>
<li>Pattern matching is not extensible.</li>
<li>Pattern matching breaks encapsulation .</li>
</ol>
</blockquote>
<p>I disagree, obviously.</p>
<p><em>``Pattern matching is unnecessary''</em> - Sure, one can use the visitor
pattern to get something similar. But visitors require a lot of code
scaffolding. Also, they don't allow nested patterns. To pick an
example (<a class="reference" href="../_/http/lamp.epfl.ch/~odersky/blogs/examples/pattern-matching.html">complete code</a>), let's say I want to simplify arithmetic expressions.
Expressions are given by the following Scala class hierarchy:</p>
<pre class="literal-block">
class Term
case class Num(n: int)           extends Term
case class Var(name: String)     extends Term
case class Mul(l: Term, r: Term) extends Term
case class Add(l: Term, r: Term) extends Term
</pre>
<p>There is a base class <tt class="literal"><span class="pre">Term</span></tt> with four subclasses: <tt class="literal"><span class="pre">Num</span></tt> for
numbers, <tt class="literal"><span class="pre">Var</span></tt> for variables, <tt class="literal"><span class="pre">Mul</span></tt> for multiplication operations,
and <tt class="literal"><span class="pre">Add</span></tt> for addition operations. So the term <tt class="literal"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">x)</span></tt> would be
represented as <tt class="literal"><span class="pre">new</span> <span class="pre">Mul(new</span> <span class="pre">Num(2),</span> <span class="pre">new</span> <span class="pre">Var(x))</span></tt>.</p>
<p>Note that each of the four subclasses has a <tt class="literal"><span class="pre">case</span></tt> modifier. This
means we can pattern match on it, and also that we get an implicit
factory method with the same name as the case class. With the
factory methods, we can abbreviate the term above to
<tt class="literal"><span class="pre">Mul(Num(2),</span> <span class="pre">Var(x))</span></tt>.</p>
<p>Now let's say we want to implement some simplification rules on such
terms.  Two useful simplifications apply the equalities:</p>
<pre class="literal-block">
0 * x  =  0
1 * x  =  x
</pre>
<p>With pattern matching they can be expressed straightforwardly:</p>
<pre class="literal-block">
def simplify(term: Term) = term match {
  case Mul(Num(0), x) =&gt; Num(0)
  case Mul(Num(1), x) =&gt; x
  case _ =&gt; term
}
</pre>
<p>How much harder is this with a visitor? I invite you to try it out!</p>
<p><em>``Pattern matching is not extensible''</em> - This assumes that pattern
matching can only be done on so-called <em>algebraic datatypes</em> which
have a fixed number of cases. This is indeed the common approach in
functional languages (an exception are <em>polymorphic variants</em> in
OCaml). In Scala, however, any class can be labeled a case class. It
would be perfectly possible to define other case classes that inherit
from <tt class="literal"><span class="pre">Term</span></tt> in different compilation units.</p>
<p><em>``Pattern matching breaks encapsulation''</em> - I think this is a
misunderstanding in that people assume that pattern matching can
inspect the internal fields of an object. But in Scala, pattern
matching simply reverses the construction process. That is, you can
find out through pattern matching what is the case class of the
selector value and what are its constructor parameters. Any internal
fields remain hidden. Also, if you don't want your clients to see the
way an object was constructed, don't mark its class as a case class.</p>
<p>So, in summary I think pattern matching is extremely convenient and is
a good fit with object-oriented programming. I wonder why not more
mainstream languages have adopted it.</p>
<h1>Talk Back!</h1>
<p>
Have an opinion?


Readers have already posted

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=166742.html">35

comments</a>
about this weblog entry. Why not

<a href="../_/https/www.artima.com/forums/post.html$/forum=106&amp;thread=166742&amp;reply=true.html">add yours</a>?


<h1>RSS Feed</h1>
<p>
If you'd like to be notified whenever Martin Odersky adds a new entry to <a href="../index.html$/blogger=modersky.html">his weblog</a>, subscribe to his <a href="../feeds/bloggers/modersky.rss">RSS feed</a>.

<center>
<div class="sociallinks">
<a href="../_/http/digg.com/submit$/phase=2&amp;url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D166742&amp;title=In+Defense+of+Pattern+Matching&amp;bodytext=Pattern+matching+is+much+maligned+by+object-oriented+programmers.+I+wonder+why%3F&amp;topic=programming">
<img alt="Digg" border="0" height="14" hspace="8" src="../_/https/www.artima.com/images/digg.gif" width="16">Digg
  </img></a>
  |
  <a href="../_/http/del.icio.us/post$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D166742&amp;title=In+Defense+of+Pattern+Matching">
<img alt="del.icio.us" border="0" height="16" hspace="8" src="../_/https/www.artima.com/images/delicious.gif" vspace="1" width="16">del.icio.us
  </img></a>
  |
  <a href="../_/http/programming.reddit.com/submit$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D166742&amp;title=In+Defense+of+Pattern+Matching">
<img alt="Reddit" border="0" height="18" hspace="8" src="../_/https/www.artima.com/images/reddit.gif" width="18"/>Reddit
  </a>
</div>
</center>
<h1>About the Blogger</h1>
<p>
<table><tr valign="bottom"><td><img align="right" src="../_/https/www.artima.com/images/martinodersky.jpg"/></td><td>Martin Odersky is the inventor of the Scala language and professor at <a href="../_/http/ic.epfl.ch/index.html">EPFL</a> in Lausanne, Switzerland. In 2008, he was appointed fellow of the ACM for his contributions to the fusion of functional and object-oriented programming. He believes the two paradigms are two sides of the same coin, to be
unified as much as possible. To prove this, he has worked on
a number of language designs, from <a href="../_/http/lampwww.epfl.ch/pizza/index.html">Pizza</a> to <a href="../_/http/lamp.epfl.ch/pizza/gj/index.html">GJ</a> to <a href="../_/http/lamp.epfl.ch/funnel/index.html">Functional Nets</a>.  He has also
influenced the development of Java as a co-designer of <a href="../_/http/jcp.org/en/jsr/detail$/id=14/index.html">Java generics</a> and as the
original author of the current <a href="../_/http/java.sun.com/j2se/1.4.2/docs/tooldocs/windows/javac.html">javac<a></a>

reference compiler.</a></td></tr></table><p>
<div class="sp">This weblog entry is Copyright © 2006 Martin Odersky. All rights reserved.</div>
</p></p></p></p></p></div>

<hr width="100%">
<table align="center" width="50%">
<tr>
<td>
<div class="horizontaltextadbox">
<div class="adheadline">Sponsored Links</div>
<div id="sponsoredlinks">
</div>
</div>
</td>
</tr>
</table>
<hr width="100%"/>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3911176865765226";
google_alternate_color = "ffffff";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "003090";
google_color_text = "000000";
google_color_url = "666666";
//--></script>
<script src="../_/https/pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<br>
<br/>
<!-- SiteSearch Google -->
<form action="../_/https/www.google.com/custom/index.html" method="get">
<table bgcolor="#ffffff" border="0">
<tr><td align="left" height="32" nowrap="nowrap" valign="top">
<a href="../_/https/www.google.com/index.html">
<img alt="Google" border="0" src="../_/https/www.google.com/logos/Logo_25wht.gif"/></a>
</td>
<td nowrap="nowrap">
<input name="domains" type="hidden" value="Artima.com"/>
<input maxlength="255" name="q" size="31" type="text" value=""/>
<input name="sa" type="submit" value="Search"/>
</td></tr>
<tr>
<td> </td>
<td nowrap="nowrap">
<font color="#000000" size="-1">
<input name="sitesearch" type="radio" value=""/> Web
<input checked="checked" name="sitesearch" type="radio" value="Artima.com"/>Artima.com
</font>  
<input name="client" type="hidden" value="pub-3911176865765226"/>
<input name="forid" type="hidden" value="1"/>
<input name="ie" type="hidden" value="ISO-8859-1"/>
<input name="oe" type="hidden" value="ISO-8859-1"/>
<input name="cof" type="hidden" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:FFFFFF;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:150;L:https://www.artima.com/images/artima150.gif;S:https://www.artima.com;FORID:1;"/>
<input name="hl" type="hidden" value="en"/>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</br></center>
<br/>
<div class="sp">
<div style="text-align: center;">
<a href="../_/https/www.artima.com/copyright.html">Copyright</a> © 1996-2019 Artima, Inc. All Rights Reserved. - <a href="../_/https/www.artima.com/privacy.html">Privacy Policy</a> - <a href="../_/https/www.artima.com/termsofuse.html">Terms of Use</a>
</div>
</div>
<br/>
<script language="JavaScript" type="text/javascript">
<!--
function initBannerVarForZone(zone) {
        initBannerVarForZoneWithScript(zone, 'adjs_modified');
}

function initBannerVarForZoneWithScript(zone, phpScript) {

        if (!document.phpAds_used) document.phpAds_used = ',';
        phpAds_random = new String (Math.random());
        phpAds_random = phpAds_random.substring(2,11);

        var nextScriptSrc = '../_/https/www.artima.com/zcr/index.html' + phpScript + '.php?n=' +
                phpAds_random  +
                '&amp;what=zone:' + zone + '&amp;target=_top&amp;block=1&amp;blockcampaign=1' +
                '&amp;exclude=' + document.phpAds_used;

        document.write("<script language='JavaScript' type='text/javascript' src='");
        document.write(nextScriptSrc);
        document.write("'><\/script>");

}

function replaceDiv(divID) {
        document.getElementById(divID).innerHTML = phpadsbanner;
}
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZone(3);
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('leftskyscraper');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZoneWithScript(4, 'textman');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('sponsoredlinks');
-->
</script>
</hr><a href="https://dafoster.net/projects/crystal-web-archiver/" id="cr-footer-banner" style="border-top: 2px #B40010 solid;background: #FFFAE1;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-variant: initial;font-weight: initial;text-transform: none;font-size: 14px;color: #6c757d;line-height: 2.0;cursor: pointer;display: flex;align-items: center;justify-content: center;gap: 4px;clear: both;" target="_blank"><img height="24" onerror="this.style['display'] = 'none';" src="../_/crystal/resources/appicon.png" width="24"/><span>This page was archived with Crystal</span><script>window.addEventListener('load', function() { const $1 = document.querySelector('#cr-footer-banner'); if (!$1) { return; } if (window !== window.top) { let $2 = false; if (window.name) { const $3 = window.parent.document.getElementsByName(window.name); if ($3.length === 1) { const $4 = $3[0]; if ($4.tagName === 'FRAME' && $4.parentElement.tagName === 'FRAMESET') { let $5 = $4; while (true) { if ($5.parentElement.tagName !== 'FRAMESET') { $2 = true; break; } if ($5.parentElement.attributes['rows'] !== undefined) { const $6 = $5.parentElement.children; if ($5 === $6[$6.length - 1]) { $5 = $5.parentElement; continue; } else { break; } } else if ($5.parentElement.attributes['cols'] !== undefined) { const $7 = Array.from($5.parentElement.children); const $8 = $7.indexOf($5); if ($8 === -1) { break; } const $9 = $5.parentElement.attributes['cols'].value.split(','); const $10 = $9.map((s) => parseInt(s.trim())); if ($9[$8].trim() === '*' || $10[$8] === Math.max.apply(null, $10)) { $5 = $5.parentElement; continue; } else { break; } } else { break; } } } } } if (!$2) { $1.style['display'] = 'none'; } } const $11 = $1.getBoundingClientRect(); const $12 = ($11.y < window.innerHeight - $11.height); if ($12) { $1.style['position'] = 'fixed'; $1.style['bottom'] = '0'; $1.style['left'] = '0'; $1.style['right'] = '0'; $1.style['z-index'] = '9999'; } const $13 = ( document.body.getBoundingClientRect().height < $11.height * 2 ); if ($13) { $1.style['display'] = 'none'; }
});</script></a></body>
</html>
