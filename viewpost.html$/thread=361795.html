
<!DOCTYPE html>

<html>
<head><meta content="noindex,nofollow" name="robots"/>
<title>Announcing Pojomatic 2.0</title>
<meta charset="utf-8"/>
<meta content="Ian Robertson" name="author">
<link href="../_/https/www.artima.com/artima.css" rel="stylesheet" type="text/css"/>
<link href="../_/https/www.artima.com/favicon.ico" rel="shortcut icon"/>
</meta></head>
<body><table cellspacing="0" width="100%">
<tr>
<td align="left" valign="bottom">
<a href="../_/https/www.artima.com/index.html"><img alt="The Artima Developer Community" border="0" height="43" src="../_/https/www.artima.com/images/a7.gif" width="550"/></a>
</td>
</tr></table>
<table bgcolor="#333333" width="100%">
<tr>
<td align="center">
<div class="ml">
<a class="hl" href="../_/https/www.artima.com/articles/index.html">Articles</a> |
<a class="hl" href="../_/https/www.artima.com/news/index.html">News</a> |
<a class="hl" href="../index.html">Weblogs</a> |
<a class="hl" href="../_/https/www.artima.com/shop/catalog/index.html">Books</a> |
<a class="hl" href="../_/https/www.artima.com/forums/index.html">Forums</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#CCCCCC" width="100%">
<tr>
<td align="center">
<div class="sc">
<a href="../index.html">Artima Weblogs</a> | 

<a href="../index.html$/blogger=ianr.html">Ian Robertson's Weblog</a> | 

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=361795.html">Discuss</a> | 
<a href="mailto:?subject=Announcing Pojomatic 2.0&amp;body= %0AArtima Weblogs %0AAnnouncing Pojomatic 2.0 %0Aby Ian Robertson %0A%0Ahttps://www.artima.com/weblogs/viewpost.jsp?thread=361795">Email</a> | 
<a href="../viewpostP.html$/thread=361795.html">Print</a> | 
<a href="../bloggers.html">Bloggers</a> | 
<a class="sl" href="thread=354443.html" title="A Hazard of Covariant Return Types and Bridge Methods">Previous</a> | 
Next
</div>
</td>
</tr>
</table>
<table bgcolor="#EEEEEE" width="100%">
<tr>
<td align="center">
<div class="sc">
<span style="color: #555555;">Sponsored Link</span> <span style="color: #888888;">•</span>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
   if (!document.phpAds_used) document.phpAds_used = ',';
   phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
   
   document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
   document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
   document.write ("&amp;what=zone:9&amp;target=_top");   document.write ("&amp;exclude=" + document.phpAds_used);
   if (document.referrer)
      document.write ("&amp;referer=" + escape(document.referrer));
   document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a799ecf6.html" target="_top"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:9&amp;n=a0587811.html"/></a></noscript>
</div>
</td>
</tr>
</table>
<br/>
<div class="vegies">
<div class="tc">
<span class="sts">Code by Any Other Name</span><br>
<span class="ts">Announcing Pojomatic 2.0</span><br/>
<span class="as">by Ian Robertson</span><br/>
<span class="pd">June 30, 2014</span><br/>
</br></div>
<blockquote>
<b>Summary</b><br/>
Pojomatic 2.0 has been released, and uses InvokeDynamic to give performance nearing that of hand-rolled code.

</blockquote>
<hr align="left" width="90%"/>
<table align="right">
<tr>
<td>
<div class="adnotice">
Advertisement
</div>
<center>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
if (!document.phpAds_used) document.phpAds_used = ',';
phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
document.write ("&amp;what=zone:2");
document.write ("&amp;exclude=" + document.phpAds_used);
if (document.referrer)
document.write ("&amp;referer=" + escape(document.referrer));
document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a74ab060.html" target="_blank"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:2&amp;n=a74ab060.html"/></a></noscript>
</center>
</td>
</tr>
</table>
<p>
<h1>Announcing Pojomatic 1.0</h1>
<p>
Version 2.0 of <a href="../_/http/www.pojomatic.org/pojomatic/index.html">Pojomatic</a> has
been released.  Pojomatic provides an easy way to implement
the <code>equals(Object)</code>, <code>hashCode()</code>
and <code>toString()</code> methods inherited
from <code>java.lang.Object</code>.
</p>
<p>
  This release targets Java 7 or higher. The reason for this is to
  take advantage of the new InvokeDynamic instruction introduced in
  Java 7. While Pojomatic 1.0 used reflection to do it's work, this
  new version generates byte code using ASM, and uses InvokeDynamic to be able
  to access potentially private members of pojomated classes. The
  result is that the performance of equals and hashCode is now close
  to that of what would be seen with hand-rolled code. (To learn more about how this is done, come see my JavaOne talk this year).
</p>
<p>
  Starting in Java 7, reflection no longer will necessarily return a
  class's elements in any particular order. Consequently, this release
  also uses ASM to read in the class file for a pojomated class, in order
  to determine the original order of fields and methods on the
  class.
</p>
<h2>Overview of Pojomatic</h2>
For those not familiar with Pojomatic, the typical work needed for most classes is:
</p>
<pre><span class="s0">import </span><span class="s1">org.pojomatic.Pojomatic;
</span><span class="s0">import </span><span class="s1">org.pojomatic.annotations.AutoProperty;

@AutoProperty // tells Pojomatic to use all non-static fields.
</span><span class="s0">public class </span><span class="s1">Pojo {
  // Fields, getters and setters...

  @Override </span><span class="s0">public boolean </span><span class="s1">equals(Object o) { </span><span class="s0">return </span><span class="s1">Pojomatic.equals(</span><span class="s0">this</span><span class="s1">, o); }
  @Override </span><span class="s0">public int </span><span class="s1">hashCode() { </span><span class="s0">return </span><span class="s1">Pojomatic.hashCode(</span><span class="s0">this</span><span class="s1">); }
  @Override </span><span class="s0">public </span><span class="s1">String toString() { </span><span class="s0">return </span><span class="s1">Pojomatic.toString(</span><span class="s0">this</span><span class="s1">); }
}</span></pre>
<p>
While this is adequate more most cases, there are numerous ways to
customize how Pojomatic will build up the implementations of
the <code>equals</code>, <code>toString</code>
and <code>hashCode</code> methods.  The
<a href="../_/http/irobertson.github.io/pojomatic/current/pojomatic/apidocs/index.html$/org/pojomatic/annotations/AutoProperty.html.html"><code>@AutoProperty</code></a>
annotation can instruct Pojomatic to use fields or getters to accesses
properties.  Alternatively, one can annotate individual fields and/or
accessor methods with the
<a href="../_/http/irobertson.github.io/pojomatic/current/pojomatic/apidocs/index.html$/org/pojomatic/annotations/Property.html.html"><code>@Property</code></a>
annotation to include them explicitely, or to exclude certain
properties if <code>@AutoProperty</code> is being used.  For any
property, a
<a href="../_/http/irobertson.github.io/pojomatic/current/pojomatic/apidocs/index.html$/org/pojomatic/annotations/PojomaticPolicy.html.html"><code>@PojomaticPolicy</code></a>
can be set to indicate which methods the property should be included
in.  By default, a property is used
for each of the <code>equals</code>, <code>hashCode</code>
and <code>toString</code> methods, but any combination is possible,
subject to the restriction that if a property is used
for <code>hashCode</code>, then it must be used
for <code>equals</code> as well.
</p>
<h2>Proper implementation of equals for class hierarchies</h2>
<p>
As discussed in
<a href="../_/http/www.artima.com/lejava/articles/equality.html"><cite>How to
Write an Equality Method in Java</cite></a>, challenges arise in
satisfying the contract for <code>equals</code> when class hierarchies
come into play.  The solution suggested in that article is to
introduce an additional method, <code>canEqual</code>, which the
implementation of <code>equals</code> will use to ensure that
instances of a parent class do not accidentally declare themselves to
be equal to an instance of a subclass which has
redefined <code>equals</code>.  If all the classes in a hierarchy use
Pojomatic, this step is not necessary; Pojomatic keeps track of
whether instances of two related classes can be equal to each other or
not via the
<a href="../_/http/irobertson.github.io/pojomatic/current/pojomatic/apidocs/org/pojomatic/Pojomatic.html#areCompatibleForEquals%28java.lang.Class,%20java.lang.Class%29"><code>areCompatibleForEquals</code></a>
method. Two classes are compatible for
equality if they each have the same set of properties designated for
use with the <code>equals</code> method. If a subclass has a need to
implement the <code>equals</code> method without using Pojomatic, it
can be annotated with
<a href="../_/http/irobertson.github.io/pojomatic/current/pojomatic/apidocs/index.html$/org/pojomatic/annotations/OverridesEquals.html.html"><code>@OverridesEquals</code></a>
to indicate that it is not compatible for equality with it's parent class.
</p>
<h2>Comparing two Pojomated instances</h2>
<p>
A common use of the <code>equals</code> method is to facilitate the use
of the <code>assertEquals</code> methods of JUnit or TestNG.
When <code>assertEquals</code> fails, the exception method includes
the <code>toString</code> representation of each instance.  One pain point which no
doubt will be familiar to many is that of trying to determine why two
instances are not equal when they have a large number of properties.
Often, the only option is to copy the failure message into an editor
which allows comparing the <code>toString</code> representations to look for
differences.  Pojomatic helps address this by adding
method, <a href="../_/http/irobertson.github.io/pojomatic/current/pojomatic/apidocs/org/pojomatic/Pojomatic.html#diff%28T,%20S%29"><code>Pojomatic.diff</code></a>
which can reveal the differences between two instances of a Pojomated
class.
The <a href="../_/http/irobertson.github.io/pojomatic/current/pojomatic-test-utils/index.html">PojomaticTestUtils</a>
library leverages this capability to provide
an <code>assertEqualsWithDiff</code> method which will call out the
differences between two instances in the failure messaged in the event
that they are not equal.
</p>
<h2>Getting Pojomatic</h2>
<p>
Pojomatic is available on the central maven repository; if you use
maven, it is just a dependency away:
</p><pre>    &lt;dependency&gt;
      &lt;groupId&gt;org.pojomatic&lt;/groupId&gt;
      &lt;artifactId&gt;pojomatic&lt;/artifactId&gt;
      &lt;version&gt;1.0&lt;/version&gt;
    &lt;/dependency&gt;
</pre>
Others can download Pojomatic from the <a href="../_/http/repo1.maven.org/maven2/org/pojomatic/index.html">central maven repository</a>.

<img align="top" height="15" src="../_/https/www.artima.com/images/ik.gif" width="15"/>
<h1>Talk Back!</h1>
<p>
Have an opinion?


Be the first to

<a href="../_/https/www.artima.com/forums/post.html$/forum=106&amp;thread=361795&amp;reply=true.html">post a comment</a> about
this weblog entry.


<h1>RSS Feed</h1>
<p>
If you'd like to be notified whenever Ian Robertson adds a new entry to <a href="../index.html$/blogger=ianr.html">his weblog</a>, subscribe to his <a href="../feeds/bloggers/ianr.rss">RSS feed</a>.

<center>
<div class="sociallinks">
<a href="../_/http/digg.com/submit$/phase=2&amp;url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D361795&amp;title=Announcing+Pojomatic+2.0&amp;bodytext=Pojomatic+2.0+has+been+released%2C+and+uses+InvokeDynamic+to+give+performance+nearing+that+of+hand-rolled+code.&amp;topic=programming">
<img alt="Digg" border="0" height="14" hspace="8" src="../_/https/www.artima.com/images/digg.gif" width="16">Digg
  </img></a>
  |
  <a href="../_/http/del.icio.us/post$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D361795&amp;title=Announcing+Pojomatic+2.0">
<img alt="del.icio.us" border="0" height="16" hspace="8" src="../_/https/www.artima.com/images/delicious.gif" vspace="1" width="16">del.icio.us
  </img></a>
  |
  <a href="../_/http/programming.reddit.com/submit$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D361795&amp;title=Announcing+Pojomatic+2.0">
<img alt="Reddit" border="0" height="18" hspace="8" src="../_/https/www.artima.com/images/reddit.gif" width="18">Reddit
  </img></a>
</div>
</center>
<h1>About the Blogger</h1>
<p>
<table><tr valign="bottom"><td><img align="right" src="../_/https/www.artima.com/images/ianRobertson.jpg"/></td><td>Ian Robertson is an application architect at Verisk Health. He is interested in finding concise means of expression in Java without sacrificing type safety. He contributes to various open source projects, including <a href="../_/http/www.jamon.org/index.html">jamon</a> and <a href="../_/http/www.pojomatic.org/index.html">pojomatic</a>.</td></tr></table><p>
<div class="sp">This weblog entry is Copyright © 2014 Ian Robertson. All rights reserved.</div>
</p></p></p></p></div>

<hr width="100%">
<table align="center" width="50%">
<tr>
<td>
<div class="horizontaltextadbox">
<div class="adheadline">Sponsored Links</div>
<div id="sponsoredlinks">
</div>
</div>
</td>
</tr>
</table>
<hr width="100%"/>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3911176865765226";
google_alternate_color = "ffffff";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "003090";
google_color_text = "000000";
google_color_url = "666666";
//--></script>
<script src="../_/https/pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<br>
<br/>
<!-- SiteSearch Google -->
<form action="../_/https/www.google.com/custom/index.html" method="get">
<table bgcolor="#ffffff" border="0">
<tr><td align="left" height="32" nowrap="nowrap" valign="top">
<a href="../_/https/www.google.com/index.html">
<img alt="Google" border="0" src="../_/https/www.google.com/logos/Logo_25wht.gif"/></a>
</td>
<td nowrap="nowrap">
<input name="domains" type="hidden" value="Artima.com"/>
<input maxlength="255" name="q" size="31" type="text" value=""/>
<input name="sa" type="submit" value="Search"/>
</td></tr>
<tr>
<td> </td>
<td nowrap="nowrap">
<font color="#000000" size="-1">
<input name="sitesearch" type="radio" value=""/> Web
<input checked="checked" name="sitesearch" type="radio" value="Artima.com"/>Artima.com
</font>  
<input name="client" type="hidden" value="pub-3911176865765226"/>
<input name="forid" type="hidden" value="1"/>
<input name="ie" type="hidden" value="ISO-8859-1"/>
<input name="oe" type="hidden" value="ISO-8859-1"/>
<input name="cof" type="hidden" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:FFFFFF;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:150;L:https://www.artima.com/images/artima150.gif;S:https://www.artima.com;FORID:1;"/>
<input name="hl" type="hidden" value="en"/>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</br></center>
<br/>
<div class="sp">
<div style="text-align: center;">
<a href="../_/https/www.artima.com/copyright.html">Copyright</a> © 1996-2019 Artima, Inc. All Rights Reserved. - <a href="../_/https/www.artima.com/privacy.html">Privacy Policy</a> - <a href="../_/https/www.artima.com/termsofuse.html">Terms of Use</a>
</div>
</div>
<br/>
<script language="JavaScript" type="text/javascript">
<!--
function initBannerVarForZone(zone) {
        initBannerVarForZoneWithScript(zone, 'adjs_modified');
}

function initBannerVarForZoneWithScript(zone, phpScript) {

        if (!document.phpAds_used) document.phpAds_used = ',';
        phpAds_random = new String (Math.random());
        phpAds_random = phpAds_random.substring(2,11);

        var nextScriptSrc = '../_/https/www.artima.com/zcr/index.html' + phpScript + '.php?n=' +
                phpAds_random  +
                '&amp;what=zone:' + zone + '&amp;target=_top&amp;block=1&amp;blockcampaign=1' +
                '&amp;exclude=' + document.phpAds_used;

        document.write("<script language='JavaScript' type='text/javascript' src='");
        document.write(nextScriptSrc);
        document.write("'><\/script>");

}

function replaceDiv(divID) {
        document.getElementById(divID).innerHTML = phpadsbanner;
}
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZone(3);
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('leftskyscraper');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZoneWithScript(4, 'textman');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('sponsoredlinks');
-->
</script>
</hr><a href="https://dafoster.net/projects/crystal-web-archiver/" id="cr-footer-banner" style="border-top: 2px #B40010 solid;background: #FFFAE1;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-variant: initial;font-weight: initial;text-transform: none;font-size: 14px;color: #6c757d;line-height: 2.0;cursor: pointer;display: flex;align-items: center;justify-content: center;gap: 4px;clear: both;" target="_blank"><img height="24" onerror="this.style['display'] = 'none';" src="../_/crystal/resources/appicon.png" width="24"/><span>This page was archived with Crystal</span><script>window.addEventListener('load', function() { const $1 = document.querySelector('#cr-footer-banner'); if (!$1) { return; } if (window !== window.top) { let $2 = false; if (window.name) { const $3 = window.parent.document.getElementsByName(window.name); if ($3.length === 1) { const $4 = $3[0]; if ($4.tagName === 'FRAME' && $4.parentElement.tagName === 'FRAMESET') { let $5 = $4; while (true) { if ($5.parentElement.tagName !== 'FRAMESET') { $2 = true; break; } if ($5.parentElement.attributes['rows'] !== undefined) { const $6 = $5.parentElement.children; if ($5 === $6[$6.length - 1]) { $5 = $5.parentElement; continue; } else { break; } } else if ($5.parentElement.attributes['cols'] !== undefined) { const $7 = Array.from($5.parentElement.children); const $8 = $7.indexOf($5); if ($8 === -1) { break; } const $9 = $5.parentElement.attributes['cols'].value.split(','); const $10 = $9.map((s) => parseInt(s.trim())); if ($9[$8].trim() === '*' || $10[$8] === Math.max.apply(null, $10)) { $5 = $5.parentElement; continue; } else { break; } } else { break; } } } } } if (!$2) { $1.style['display'] = 'none'; } } const $11 = $1.getBoundingClientRect(); const $12 = ($11.y < window.innerHeight - $11.height); if ($12) { $1.style['position'] = 'fixed'; $1.style['bottom'] = '0'; $1.style['left'] = '0'; $1.style['right'] = '0'; $1.style['z-index'] = '9999'; } const $13 = ( document.body.getBoundingClientRect().height < $11.height * 2 ); if ($13) { $1.style['display'] = 'none'; }
});</script></a></body>
</html>
