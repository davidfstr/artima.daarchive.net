
<!DOCTYPE html>

<html>
<head><meta content="noindex,nofollow" name="robots"/>
<title>Mixins considered harmful/1</title>
<meta charset="utf-8"/>
<meta content="Michele Simionato" name="author">
<link href="../_/https/www.artima.com/artima.css" rel="stylesheet" type="text/css"/>
<link href="../_/https/www.artima.com/favicon.ico" rel="shortcut icon"/>
</meta></head>
<body><table cellspacing="0" width="100%">
<tr>
<td align="left" valign="bottom">
<a href="../_/https/www.artima.com/index.html"><img alt="The Artima Developer Community" border="0" height="43" src="../_/https/www.artima.com/images/a7.gif" width="550"/></a>
</td>
</tr></table>
<table bgcolor="#333333" width="100%">
<tr>
<td align="center">
<div class="ml">
<a class="hl" href="../_/https/www.artima.com/articles/index.html">Articles</a> |
<a class="hl" href="../_/https/www.artima.com/news/index.html">News</a> |
<a class="hl" href="../index.html">Weblogs</a> |
<a class="hl" href="../_/https/www.artima.com/shop/catalog/index.html">Books</a> |
<a class="hl" href="../_/https/www.artima.com/forums/index.html">Forums</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#CCCCCC" width="100%">
<tr>
<td align="center">
<div class="sc">
<a href="../index.html">Artima Weblogs</a> | 

<a href="../index.html$/blogger=micheles.html">Michele Simionato's Weblog</a> | 

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=246341.html">Discuss</a> | 
<a href="mailto:?subject=Mixins considered harmful/1&amp;body= %0AArtima Weblogs %0AMixins considered harmful/1 %0Aby Michele Simionato %0A%0Ahttps://www.artima.com/weblogs/viewpost.jsp?thread=246341">Email</a> | 
<a href="../viewpostP.html$/thread=246341.html">Print</a> | 
<a href="../bloggers.html">Bloggers</a> | 
<a class="sl" href="thread=245050.html" title="The decorator module version 3 is out!">Previous</a> | 
<a class="sl" href="thread=246386.html" title="Ubuntu on the EeePC">Next</a>
</div>
</td>
</tr>
</table>
<table bgcolor="#EEEEEE" width="100%">
<tr>
<td align="center">
<div class="sc">
<span style="color: #555555;">Sponsored Link</span> <span style="color: #888888;">•</span>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
   if (!document.phpAds_used) document.phpAds_used = ',';
   phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
   
   document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
   document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
   document.write ("&amp;what=zone:9&amp;target=_top");   document.write ("&amp;exclude=" + document.phpAds_used);
   if (document.referrer)
      document.write ("&amp;referer=" + escape(document.referrer));
   document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a799ecf6.html" target="_top"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:9&amp;n=a0587811.html"/></a></noscript>
</div>
</td>
</tr>
</table>
<br/>
<div class="vegies">
<div class="tc">
<span class="sts">The Explorer</span><br>
<span class="ts">Mixins considered harmful/1</span><br/>
<span class="as">by Michele Simionato</span><br/>
<span class="pd">January 1, 2009</span><br/>
</br></div>
<blockquote>
<b>Summary</b><br/>
A mixin is a collection of methods that can be injected into a class.
The mixin technique consists in building classes by composing reusable mixins. The advantages and disadvantages of the technique are very much debated. I will focus on the negative aspects.

</blockquote>
<hr align="left" width="90%"/>
<table align="right">
<tr>
<td>
<div class="adnotice">
Advertisement
</div>
<center>
<script language="JavaScript" src="../_/https/www.artima.com/zcr/adx.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
if (!document.phpAds_used) document.phpAds_used = ',';
phpAds_random = new String (Math.random()); phpAds_random = phpAds_random.substring(2,11);
document.write ("<" + "script language='JavaScript' type='text/javascript' src='");
document.write ("../_/https/www.artima.com/zcr/adjs.html$/n=.html" + phpAds_random);
document.write ("&amp;what=zone:2");
document.write ("&amp;exclude=" + document.phpAds_used);
if (document.referrer)
document.write ("&amp;referer=" + escape(document.referrer));
document.write ("'><" + "/script>");
//-->
</script><noscript><a href="../_/https/www.artima.com/zcr/adclick.html$/n=a74ab060.html" target="_blank"><img alt="" border="0" src="../_/https/www.artima.com/zcr/adview.html$/what=zone:2&amp;n=a74ab060.html"/></a></noscript>
</center>
</td>
</tr>
</table>
<p>
<p>The idea of creating classes by composing reusable collections of
methods is quite old: for instance <a class="reference" href="../_/http/en.wikipedia.org/wiki/Flavors_(computer_science)/index.html">Flavors</a>, and old Lisp dialect,
featured mixins more that 25 years ago.  Nevertheless, there are
still people thinking that the idea is new and cool: as a consequence,
we see a lot of new code where the idea is misused or
abused. Writing a paper showing the downfalls of mixins is
in my opinion worth the effort.</p>
<p>Injecting methods into a class namespace is a bad idea for a very
simple reason: every time you use a mixin,
you are actually polluting your class namespace and losing track of the
origin of your methods. In this sense, using a mixin in a class is just
as bad as using <tt class="docutils literal"><span class="pre">from</span> <span class="pre">module</span> <span class="pre">import</span> <span class="pre">*</span></tt> in a module.
However, everybody agrees that it is much better to
use the full form <tt class="docutils literal"><span class="pre">mymodule.myname</span></tt> instead of importing all
the names in the global namespace, but nobody realizes that
importing methods into a class via a mixin is potentially just as bad.</p>
<p>At worst, using mixins can become
just a modern way of writing spaghetti code.
In order to explain what the problem is, I will show two real life
Python frameworks making use of mixins: Tkinter e Zope.</p>
<div class="section">
<h1><a id="mixins-in-real-life" name="mixins-in-real-life">Mixins in real life</a></h1>
<p><a class="reference" href="../_/http/www.pythonware.com/library/tkinter/introduction/x275-mixins.htm">Tkinter</a> is a GUI framework which is part of Python standard library.
It is a case where mixins work decently well, because it is a small
framework, but it is also large enough that it is possible to see the
beginning of the problem.</p>
<p>Every Tkinter class, even the simple <tt class="docutils literal"><span class="pre">Label</span></tt> is composed by multiple
mixins:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; import Tkinter, inspect
&gt;&gt;&gt; for i, cls in enumerate(inspect.getmro(Tkinter.Label)):
...     # show the ancestors
...     print i, cls
0 Tkinter.Label
1 Tkinter.Widget
2 Tkinter.BaseWidget
3 Tkinter.Misc
4 Tkinter.Pack
5 Tkinter.Place
6 Tkinter.Grid
</pre>
</blockquote>
<p>The standard library function <tt class="docutils literal"><span class="pre">inspect.getmro(cls)</span></tt>
returns a tuple with the ancestors of <tt class="docutils literal"><span class="pre">cls</span></tt>, in the order specified by
the Method Resolution Order (MRO). In our example the MRO of
<tt class="docutils literal"><span class="pre">Label</span></tt> contains the geometry mixins (<tt class="docutils literal"><span class="pre">Grid</span></tt>, <tt class="docutils literal"><span class="pre">Pack</span></tt> and <tt class="docutils literal"><span class="pre">Place</span></tt>)
and the generic mixin <tt class="docutils literal"><span class="pre">Misc</span></tt> which provides a lot of functionality
by delegating to the underlying Tk library.
The classes <tt class="docutils literal"><span class="pre">BaseWidget</span></tt>, <tt class="docutils literal"><span class="pre">Widget</span></tt>
and <tt class="docutils literal"><span class="pre">Label</span></tt> have state and they take the role of base
classes, not mixins.</p>
<div class="figure">
<img alt="../_/http/www.phyast.pitt.edu/~micheles/python/Label.png" src="../_/http/www.phyast.pitt.edu/~micheles/python/Label.png">
</img></div>
<p>You should see what I mean by <em>namespace pollution</em>: if you use any
IDE with an autocompletion feature (or even ipython): if you try to
complete the expression <tt class="docutils literal"><span class="pre">Tkinter.Label.</span></tt>,  you will get 181 choices.
181 attributes on a single class are <em>a lot</em>. If you invoke the builtin
help</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; help(Tkinter.Label)
</pre>
</blockquote>
<p>you will see the origin of the different attributes, i.e. the classes
from which they come: the output spans a few hundreds of lines.</p>
<p>Luckily, Tkinter is a very stable framework (I mean: it works)
and there is no need to investigate the hierarchies to find bugs
or the reason for unexpected behavior. Moreover Tkinter is a comparatively
small framework: 181 attributes are many, but not too many, and with some
effort one could manage to find out their origin. Things are however very
much different in the case of Zope/Plone.</p>
<p>For instance, have a look at the hierarchy of the <a class="reference" href="../_/http/www.phyast.pitt.edu/~micheles/python/plone-hierarchy.png">Plone Site</a> class
which I report in appendix. Between square backets you can see the
number of methods/attributes defined per class, except special attributes.
The plot comes from
a real Plone application I have in production. The total count is of
38 classes, 88 names overridden, 42 special names and 648 regular
names: a monster.</p>
<p>To trace the origin of the methods and to keep in mind the hierarchy
is practically impossibile. Moreover, both autocompletion and the builtin
help facility become unusable, the self-generated class documentation
become unreadable since too big.</p>
<p>In other words, a design based on mixins works for small frameworks, but
it does not scale at all to large frameworks. Actually, Zope 3 has
been entirely rewritten with the goal of avoiding the mixin abuse of
Zope 2 and to use composition instead of inheritance (this is basically
what the buzzwords <a class="reference" href="../_/http/www.muthukadan.net/docs/zca.html">Component Architecture</a> really mean).</p>
<p>My <em>hate</em> for mixins comes from my experience with Zope/Plone.
However the same abuses could be equally be done in other languages and
object systems - with the notable exception of CLOS, where methods are defined
outside classes and therefore the problem of class namespace pollution
does not exist - in the presence of huge frameworks.</p>
<p>A consequence of namespace pollution is that it is very easy to have
name clashes. Since there are hundreds of methods and it is impossible
to know all of them, and since method overriding is silent, this is
a real problem: the <em>very first time</em> I subclassed a Plone class I run
into this issue: I overrode a pre-defined method inadvertently, by causing
hard to investigate problems in an unrelated part of the code.</p>
</div>
<div class="section">
<h1><a id="how-to-avoid-accidental-overriding" name="how-to-avoid-accidental-overriding">How to avoid accidental overriding</a></h1>
<p>The first thing I did after being bitten by Plone was to write an
utility function to identify the overridden methods. Let me show
here a simplified version of that function, called <tt class="docutils literal"><span class="pre">warn_overriding</span></tt>.</p>
<p>You can use it when you need to work with a big framework which
you do not know well.</p>
<p>First of all, it is convenient to introduce a couple of utility functions:
<tt class="docutils literal"><span class="pre">getpublicnames</span></tt> to get the public names in a namespace</p>
<pre class="literal-block">
def getpublicnames(obj):
    "Return the public names in obj.__dict__"
    return set(n for n in vars(obj) if not n.startswith('_'))
</pre>
<p>and <tt class="docutils literal"><span class="pre">find_common_names</span></tt> to extract the common names from a set of
classes:</p>
<pre class="literal-block">
def find_common_names(classes):
    "Perform n*(n-1)/2 namespace overlapping checks on a set of n classes"
    n = len(classes)
    names = map(getpublicnames, classes)
    for i in range(0, n):
        for j in range(i+1, n):
            ci, cj = classes[i], classes[j]
            common = names[i] &amp; names[j]
            if common:
                yield common, ci, cj
</pre>
<p>Moreover, it is convenient to define a warning class:</p>
<pre class="literal-block">
class OverridingWarning(Warning):
    pass
</pre>
<p>Now it is easy to implement <tt class="docutils literal"><span class="pre">warn_overriding</span></tt> as a class decorator.</p>
<pre class="literal-block">
def warn_overriding(cls):
    """
    Print a warning for each public name which is overridden in the class
    hierarchy, unless if is listed in the "override" class attribute.
    """
    override = set(vars(cls).get("override", []))
    ancestors = inspect.getmro(cls)
    if ancestors[-1] is object: # remove the trivial ancestor &lt;object&gt;
        ancestors = ancestors[:-1]
    for common, c1, c2 in find_common_names(ancestors):
        overridden = ', '.join(common - override)
        if ',' in overridden: # for better display of the names
            overridden = '{%s}' % overridden
        if overridden:
            msg = '%s.%s overriding %s.%s' % (
                c1.__name__, overridden, c2.__name__, overridden)
            warnings.warn(msg, OverridingWarning, stacklevel=2)
    return cls
</pre>
<p>Here is an example to show how it works in practice.
Given the base classes</p>
<pre class="literal-block">
class Base(object):
    def m1(self):
        pass
    def spam(self):
        pass
</pre>
<pre class="literal-block">
class M1(object):
    def m2(self):
        pass
    def ham(self):
        pass
</pre>
<pre class="literal-block">
class M2(object):
    def m3(self):
        pass
    def spam(self):
        pass
</pre>
<p>we can define the subclass</p>
<pre class="literal-block">
class Child(Base, M1, M2):
    def ham(self):
        pass
    def spam(self):
        pass
    def m1(self):
        pass
</pre>
<p>which features method overriding. The overriding is specified by the MRO,
which includes five classes:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; inspect.getmro(Child)
(&lt;class "Child"&gt;, &lt;class "Base"&gt;, &lt;class "M1"&gt;, &lt;class "M2"&gt;, &lt;type "object"&gt;)
</pre>
</blockquote>
<p><tt class="docutils literal"><span class="pre">find_common_names</span></tt> takes those classes
(except <tt class="docutils literal"><span class="pre">object</span></tt> which does not provide any public name)
and look for common names which are printed by
<tt class="docutils literal"><span class="pre">warn_overriding</span></tt>:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; Child = warn_overriding(Child)
OverridingWarning: Child.{m1, spam} overriding Base.{m1, spam}
OverridingWarning: Child.ham overriding M1.ham
OverridingWarning: Child.spam overriding M2.spam
OverridingWarning: Base.spam overriding M2.spam
</pre>
</blockquote>
<p>In recent versions of Python (2.6+) it is possible to use
the elegant syntax</p>
<pre class="literal-block">
@warn_overriding
class Child(Base, M1, M2):
    ...
</pre>
<p>The advantages of the class decorator syntax are clear: the
decorator is much more visible since it comes <em>before</em> the class
and not after; moreover the warning prints the line number
corresponding to the class definition, the right place where
to look in case of overriding. It is possible to avoid the warnings
by listing explicitly the overriding methods in the <tt class="docutils literal"><span class="pre">.override</span></tt>
class attribute. For instance, try to add the line:</p>
<pre class="literal-block">
override = ['m1', 'spam', 'ham']
</pre>
<p>in the definition of <tt class="docutils literal"><span class="pre">Child</span></tt> and you will see that the warnings
will disappear</p>
<p><tt class="docutils literal"><span class="pre">warn_overriding</span></tt> is a small tool which can help you when you are fighting
with a big framework, but it is not a solution. The solution is not to
use mixins in the first place. The next articles in this series will
discuss a few alternatives.</p>
</div>
<div class="section">
<h1><a id="appendix-the-hierarchy-of-plone-site" name="appendix-the-hierarchy-of-plone-site">Appendix: the hierarchy of Plone Site</a></h1>
<p>Here is the picture: if it is too big to fit in your screen, that
proves my point against mixins ;)</p>
<div class="figure">
<img alt="../_/http/www.phyast.pitt.edu/~micheles/python/plone-hierarchy.png" src="../_/http/www.phyast.pitt.edu/~micheles/python/plone-hierarchy.png">
</img></div>
</div>
<h1>Talk Back!</h1>
<p>
Have an opinion?


Readers have already posted

<a href="../_/https/www.artima.com/forums/flat.html$/forum=106&amp;thread=246341.html">12

comments</a>
about this weblog entry. Why not

<a href="../_/https/www.artima.com/forums/post.html$/forum=106&amp;thread=246341&amp;reply=true.html">add yours</a>?


<h1>RSS Feed</h1>
<p>
If you'd like to be notified whenever Michele Simionato adds a new entry to <a href="../index.html$/blogger=micheles.html">his weblog</a>, subscribe to his <a href="../feeds/bloggers/micheles.rss">RSS feed</a>.

<center>
<div class="sociallinks">
<a href="../_/http/digg.com/submit$/phase=2&amp;url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D246341&amp;title=Mixins+considered+harmful%2F1&amp;bodytext=A+mixin+is+a+collection+of+methods+that+can+be+injected+into+a+class.%0D%0AThe+mixin+technique+consists+in+building+classes+by+composing+reusable+mixins.+The+advantages+and+disadvantages+of+the+technique+are+very+much+debated.+I+will+focus+on+the+negative+_&amp;topic=programming">
<img alt="Digg" border="0" height="14" hspace="8" src="../_/https/www.artima.com/images/digg.gif" width="16"/>Digg
  </a>
  |
  <a href="../_/http/del.icio.us/post$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D246341&amp;title=Mixins+considered+harmful%2F1">
<img alt="del.icio.us" border="0" height="16" hspace="8" src="../_/https/www.artima.com/images/delicious.gif" vspace="1" width="16"/>del.icio.us
  </a>
  |
  <a href="../_/http/programming.reddit.com/submit$/url=http%3A%2F%2Fwww.artima.com%2Fweblogs%2Fviewpost.jsp%3Fthread%3D246341&amp;title=Mixins+considered+harmful%2F1">
<img alt="Reddit" border="0" height="18" hspace="8" src="../_/https/www.artima.com/images/reddit.gif" width="18"/>Reddit
  </a>
</div>
</center>
<h1>About the Blogger</h1>
<p>
<table><tr valign="bottom"><td><img align="right" src="../_/https/www.artima.com/images/micheleSimionato.jpg"/></td><td>Michele Simionato started his career as a Theoretical Physicist, working in Italy, France and the U.S. He turned to programming in 2003; since then he has been working professionally as a Python developer and now he lives in Milan, Italy. Michele is well known in the Python community for his posts in the newsgroup(s), his articles and his Open Source libraries and recipes. His interests include object oriented programming, functional programming, and in general programming metodologies that enable us to manage the complexity of modern software developement.</td></tr></table><p>
<div class="sp">This weblog entry is Copyright © 2009 Michele Simionato. All rights reserved.</div>
</p></p></p></p></p></div>

<hr width="100%">
<table align="center" width="50%">
<tr>
<td>
<div class="horizontaltextadbox">
<div class="adheadline">Sponsored Links</div>
<div id="sponsoredlinks">
</div>
</div>
</td>
</tr>
</table>
<hr width="100%"/>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3911176865765226";
google_alternate_color = "ffffff";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "003090";
google_color_text = "000000";
google_color_url = "666666";
//--></script>
<script src="../_/https/pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<br>
<br/>
<!-- SiteSearch Google -->
<form action="../_/https/www.google.com/custom/index.html" method="get">
<table bgcolor="#ffffff" border="0">
<tr><td align="left" height="32" nowrap="nowrap" valign="top">
<a href="../_/https/www.google.com/index.html">
<img alt="Google" border="0" src="../_/https/www.google.com/logos/Logo_25wht.gif"/></a>
</td>
<td nowrap="nowrap">
<input name="domains" type="hidden" value="Artima.com"/>
<input maxlength="255" name="q" size="31" type="text" value=""/>
<input name="sa" type="submit" value="Search"/>
</td></tr>
<tr>
<td> </td>
<td nowrap="nowrap">
<font color="#000000" size="-1">
<input name="sitesearch" type="radio" value=""/> Web
<input checked="checked" name="sitesearch" type="radio" value="Artima.com"/>Artima.com
</font>  
<input name="client" type="hidden" value="pub-3911176865765226"/>
<input name="forid" type="hidden" value="1"/>
<input name="ie" type="hidden" value="ISO-8859-1"/>
<input name="oe" type="hidden" value="ISO-8859-1"/>
<input name="cof" type="hidden" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:FFFFFF;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:150;L:https://www.artima.com/images/artima150.gif;S:https://www.artima.com;FORID:1;"/>
<input name="hl" type="hidden" value="en"/>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</br></center>
<br/>
<div class="sp">
<div style="text-align: center;">
<a href="../_/https/www.artima.com/copyright.html">Copyright</a> © 1996-2019 Artima, Inc. All Rights Reserved. - <a href="../_/https/www.artima.com/privacy.html">Privacy Policy</a> - <a href="../_/https/www.artima.com/termsofuse.html">Terms of Use</a>
</div>
</div>
<br/>
<script language="JavaScript" type="text/javascript">
<!--
function initBannerVarForZone(zone) {
        initBannerVarForZoneWithScript(zone, 'adjs_modified');
}

function initBannerVarForZoneWithScript(zone, phpScript) {

        if (!document.phpAds_used) document.phpAds_used = ',';
        phpAds_random = new String (Math.random());
        phpAds_random = phpAds_random.substring(2,11);

        var nextScriptSrc = '../_/https/www.artima.com/zcr/index.html' + phpScript + '.php?n=' +
                phpAds_random  +
                '&amp;what=zone:' + zone + '&amp;target=_top&amp;block=1&amp;blockcampaign=1' +
                '&amp;exclude=' + document.phpAds_used;

        document.write("<script language='JavaScript' type='text/javascript' src='");
        document.write(nextScriptSrc);
        document.write("'><\/script>");

}

function replaceDiv(divID) {
        document.getElementById(divID).innerHTML = phpadsbanner;
}
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZone(3);
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('leftskyscraper');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
initBannerVarForZoneWithScript(4, 'textman');
-->
</script>
<script language="JavaScript" type="text/javascript">
<!--
replaceDiv('sponsoredlinks');
-->
</script>
</hr><a href="https://dafoster.net/projects/crystal-web-archiver/" id="cr-footer-banner" style="border-top: 2px #B40010 solid;background: #FFFAE1;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-variant: initial;font-weight: initial;text-transform: none;font-size: 14px;color: #6c757d;line-height: 2.0;cursor: pointer;display: flex;align-items: center;justify-content: center;gap: 4px;clear: both;" target="_blank"><img height="24" onerror="this.style['display'] = 'none';" src="../_/crystal/resources/appicon.png" width="24"/><span>This page was archived with Crystal</span><script>window.addEventListener('load', function() { const $1 = document.querySelector('#cr-footer-banner'); if (!$1) { return; } if (window !== window.top) { let $2 = false; if (window.name) { const $3 = window.parent.document.getElementsByName(window.name); if ($3.length === 1) { const $4 = $3[0]; if ($4.tagName === 'FRAME' && $4.parentElement.tagName === 'FRAMESET') { let $5 = $4; while (true) { if ($5.parentElement.tagName !== 'FRAMESET') { $2 = true; break; } if ($5.parentElement.attributes['rows'] !== undefined) { const $6 = $5.parentElement.children; if ($5 === $6[$6.length - 1]) { $5 = $5.parentElement; continue; } else { break; } } else if ($5.parentElement.attributes['cols'] !== undefined) { const $7 = Array.from($5.parentElement.children); const $8 = $7.indexOf($5); if ($8 === -1) { break; } const $9 = $5.parentElement.attributes['cols'].value.split(','); const $10 = $9.map((s) => parseInt(s.trim())); if ($9[$8].trim() === '*' || $10[$8] === Math.max.apply(null, $10)) { $5 = $5.parentElement; continue; } else { break; } } else { break; } } } } } if (!$2) { $1.style['display'] = 'none'; } } const $11 = $1.getBoundingClientRect(); const $12 = ($11.y < window.innerHeight - $11.height); if ($12) { $1.style['position'] = 'fixed'; $1.style['bottom'] = '0'; $1.style['left'] = '0'; $1.style['right'] = '0'; $1.style['z-index'] = '9999'; } const $13 = ( document.body.getBoundingClientRect().height < $11.height * 2 ); if ($13) { $1.style['display'] = 'none'; }
});</script></a></body>
</html>
